(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9469],{35342:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ai-tutoring",function(){return t(8696)}])},8696:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var a=t(85893),n=t(67294),i=t(9008),r=t.n(i),l=t(11163),o=t(32798),c=t(36197);let d=e=>{let{sessionType:s="conversation",onComplete:t}=e,i=(0,l.useRouter)(),{user:r}=(0,c.Eu)(),[d,x]=(0,n.useState)(null),[m,u]=(0,n.useState)([]),[g,h]=(0,n.useState)(""),[p,b]=(0,n.useState)(!1),[f,j]=(0,n.useState)(!0),[y,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!0),D=(0,n.useRef)(null);(0,n.useEffect)(()=>{E()},[s]),(0,n.useEffect)(()=>{S()},[m]);let S=()=>{var e;null===(e=D.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},E=async()=>{try{var e;j(!0);let t=await (null===(e=o.qV.startTutoringSession)||void 0===e?void 0:e.call(o.qV,{sessionType:s,cefrLevel:(null==r?void 0:r.cefrLevel)||"A1"}));t&&setTimeout(()=>{x(t),u(t.messages||[])},0)}catch(e){console.error("Error initializing AI session:",e)}finally{j(!1)}},_=async()=>{if(!g.trim()||!d)return;let e={_id:Date.now().toString(),role:"student",content:g,timestamp:new Date().toISOString(),messageType:"text"};u(s=>[...s,e]),h(""),b(!0);try{var s;let e=await (null===(s=o.qV.sendTutoringMessage)||void 0===s?void 0:s.call(o.qV,d._id,{content:g,messageType:"text"}));(null==e?void 0:e.message)&&u(s=>[...s,e.message]),(null==e?void 0:e.session)&&x(e.session)}catch(s){console.error("Error sending message:",s);let e={_id:Date.now().toString(),role:"ai",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date().toISOString(),messageType:"text"};u(s=>[...s,e])}finally{b(!1)}},T=async()=>{try{v(!0),setTimeout(()=>{v(!1);let e={_id:Date.now().toString(),role:"student",content:"[Audio message]",timestamp:new Date().toISOString(),messageType:"audio",audioUrl:"/sample-audio.mp3"};u(s=>[...s,e])},3e3)}catch(e){console.error("Error starting recording:",e),v(!1)}},k=async()=>{if(d)try{let e=await o.qV.endTutoringSession(d._id);x(e),t?t(e):i.push("/ai-tutoring/session/".concat(d._id,"/results"))}catch(e){console.error("Error ending session:",e)}};return f?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Initializing AI tutor..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"text-2xl",children:{conversation:"\uD83D\uDCAC",grammar:"\uD83D\uDCDD",pronunciation:"\uD83D\uDDE3️",writing:"✍️",reading:"\uD83D\uDCD6",listening:"\uD83D\uDC42"}[s]||"\uD83E\uDD16"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"AI Tutor"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 capitalize",children:[s," Session"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"px-3 py-1 text-sm font-medium rounded-full ".concat({conversation:"bg-blue-100 text-blue-800",grammar:"bg-green-100 text-green-800",pronunciation:"bg-purple-100 text-purple-800",writing:"bg-yellow-100 text-yellow-800",reading:"bg-indigo-100 text-indigo-800",listening:"bg-pink-100 text-pink-800"}[s]||"bg-gray-100 text-gray-800"),children:s}),(0,a.jsx)("button",{onClick:k,className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 transition-colors",children:"End Session"})]})]})})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col max-w-4xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex-1 bg-white rounded-lg shadow-md flex flex-col",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[m.map(e=>(0,a.jsx)("div",{className:"flex ".concat("student"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg ".concat("student"===e.role?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[(0,a.jsx)("div",{className:"text-sm",children:e.content}),e.corrections&&N&&e.corrections.length>0&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Corrections:"}),e.corrections.map((e,s)=>(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"line-through text-red-400",children:e.original}),(0,a.jsx)("span",{className:"mx-1",children:"→"}),(0,a.jsx)("span",{className:"text-green-600 font-medium",children:e.corrected}),(0,a.jsx)("div",{className:"text-gray-500 mt-1",children:e.explanation})]},s))]}),e.suggestions&&e.suggestions.length>0&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Suggestions:"}),e.suggestions.map((e,s)=>(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:e.suggestion}),(0,a.jsx)("div",{className:"text-gray-500 mt-1",children:e.explanation})]},s))]}),e.audioUrl&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,a.jsx)("source",{src:e.audioUrl,type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),(0,a.jsx)("div",{className:"text-xs opacity-70 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]})},e._id)),p&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-gray-100 text-gray-900 max-w-xs lg:max-w-md px-4 py-2 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-pulse",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),(0,a.jsx)("div",{ref:D})]}),(0,a.jsxs)("div",{className:"border-t p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("textarea",{value:g,onChange:e=>h(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),_())},placeholder:"Type your message...",rows:1,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",disabled:p})}),(0,a.jsx)("button",{onClick:_,disabled:!g.trim()||p,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Send"}),(0,a.jsx)("button",{onClick:y?()=>{v(!1)}:T,disabled:p,className:"px-4 py-2 rounded-lg transition-colors ".concat(y?"bg-red-600 text-white hover:bg-red-700":"bg-gray-600 text-white hover:bg-gray-700"," disabled:opacity-50 disabled:cursor-not-allowed"),children:y?"⏹️":"\uD83C\uDFA4"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsx)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:N,onChange:e=>w(e.target.checked),className:"mr-2"}),"Show corrections"]})}),d&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Session time: ",Math.floor((Date.now()-new Date(d.startedAt).getTime())/1e3/60),"m"]})]})]})]}),d&&(0,a.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Skills Progress"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(d.skills).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[t,"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600 capitalize",children:s}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(t,"%")}})})]},s)})})]})]})]})};function x(){let{user:e,loading:s}=(0,c.Eu)(),t=(0,l.useRouter)();return((0,n.useEffect)(()=>{s||e||t.push("/login")},[e,s,t]),s)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:"AI Tutoring - Verbfy"}),(0,a.jsx)("meta",{name:"description",content:"Start your AI-powered English tutoring session"})]}),(0,a.jsx)(d,{sessionType:"conversation",onComplete:e=>{console.log("AI session completed:",e),t.push("/ai-tutoring/session/".concat(e._id,"/results"))}})]}):null}}},function(e){e.O(0,[1216,2888,179],function(){return e(e.s=35342)}),_N_E=e.O()}]);
//# sourceMappingURL=ai-tutoring-5ce15109ea2d2f1a.js.map