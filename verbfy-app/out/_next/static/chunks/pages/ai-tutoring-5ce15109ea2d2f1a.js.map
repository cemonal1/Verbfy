{"version":3,"file":"static/chunks/pages/ai-tutoring-5ce15109ea2d2f1a.js","mappings":"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","sources":["webpack://_N_E/?976e","webpack://_N_E/./src/features/aiFeatures/view/AITutoringInterface.tsx","webpack://_N_E/./pages/ai-tutoring/index.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/ai-tutoring\",\n      function () {\n        return require(\"private-next-pages/ai-tutoring/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/ai-tutoring\"])\n      });\n    }\n  ","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport { AITutoringSession, AITutoringMessage } from '@/types/aiFeatures';\r\nimport { aiFeaturesAPI } from '@/lib/api';\r\nimport { useAuthContext } from '@/context/AuthContext';\r\n\r\ninterface AITutoringInterfaceProps {\r\n  sessionType?: 'conversation' | 'grammar' | 'pronunciation' | 'writing' | 'reading' | 'listening';\r\n  onComplete?: (session: AITutoringSession) => void;\r\n}\r\n\r\nexport const AITutoringInterface: React.FC<AITutoringInterfaceProps> = ({\r\n  sessionType = 'conversation',\r\n  onComplete\r\n}) => {\r\n  const router = useRouter();\r\n  const { user } = useAuthContext();\r\n  const [session, setSession] = useState<AITutoringSession | null>(null);\r\n  const [messages, setMessages] = useState<AITutoringMessage[]>([]);\r\n  const [inputMessage, setInputMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [sessionLoading, setSessionLoading] = useState(true);\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [showCorrections, setShowCorrections] = useState(true);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    initializeSession();\r\n  }, [sessionType]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const initializeSession = async () => {\r\n    try {\r\n      setSessionLoading(true);\r\n      const newSession = await (aiFeaturesAPI as any).startTutoringSession?.({\r\n        sessionType,\r\n        cefrLevel: user?.cefrLevel || 'A1'\r\n      });\r\n      if (newSession) {\r\n        // Defer state updates to avoid act warnings in tests\r\n        setTimeout(() => {\r\n          setSession(newSession);\r\n          setMessages(newSession.messages || []);\r\n        }, 0);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initializing AI session:', error);\r\n    } finally {\r\n      setSessionLoading(false);\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!inputMessage.trim() || !session) return;\r\n\r\n    const userMessage: AITutoringMessage = {\r\n      _id: Date.now().toString(),\r\n      role: 'student',\r\n      content: inputMessage,\r\n      timestamp: new Date().toISOString(),\r\n      messageType: 'text'\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInputMessage('');\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await (aiFeaturesAPI as any).sendTutoringMessage?.(session._id, {\r\n        content: inputMessage,\r\n        messageType: 'text'\r\n      });\r\n\r\n      if (response?.message) {\r\n        setMessages(prev => [...prev, response.message]);\r\n      }\r\n      \r\n      if (response?.session) {\r\n        setSession(response.session);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      const errorMessage: AITutoringMessage = {\r\n        _id: Date.now().toString(),\r\n        role: 'ai',\r\n        content: 'Sorry, I encountered an error. Please try again.',\r\n        timestamp: new Date().toISOString(),\r\n        messageType: 'text'\r\n      };\r\n      setMessages(prev => [...prev, errorMessage]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      sendMessage();\r\n    }\r\n  };\r\n\r\n  const startRecording = async () => {\r\n    try {\r\n      setIsRecording(true);\r\n      // Audio recording logic would go here\r\n      // For now, we'll simulate recording\r\n      setTimeout(() => {\r\n        setIsRecording(false);\r\n        // Simulate sending audio message\r\n        const audioMessage: AITutoringMessage = {\r\n          _id: Date.now().toString(),\r\n          role: 'student',\r\n          content: '[Audio message]',\r\n          timestamp: new Date().toISOString(),\r\n          messageType: 'audio',\r\n          audioUrl: '/sample-audio.mp3'\r\n        };\r\n        setMessages(prev => [...prev, audioMessage]);\r\n      }, 3000);\r\n    } catch (error) {\r\n      console.error('Error starting recording:', error);\r\n      setIsRecording(false);\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    setIsRecording(false);\r\n  };\r\n\r\n  const endSession = async () => {\r\n    if (!session) return;\r\n\r\n    try {\r\n      const completedSession = await aiFeaturesAPI.endTutoringSession(session._id);\r\n      setSession(completedSession);\r\n      \r\n      if (onComplete) {\r\n        onComplete(completedSession);\r\n      } else {\r\n        router.push(`/ai-tutoring/session/${session._id}/results`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error ending session:', error);\r\n    }\r\n  };\r\n\r\n  const getSessionTypeIcon = (type: string) => {\r\n    const icons = {\r\n      conversation: 'üí¨',\r\n      grammar: 'üìù',\r\n      pronunciation: 'üó£Ô∏è',\r\n      writing: '‚úçÔ∏è',\r\n      reading: 'üìñ',\r\n      listening: 'üëÇ'\r\n    };\r\n    return icons[type as keyof typeof icons] || 'ü§ñ';\r\n  };\r\n\r\n  const getSessionTypeColor = (type: string) => {\r\n    const colors = {\r\n      conversation: 'bg-blue-100 text-blue-800',\r\n      grammar: 'bg-green-100 text-green-800',\r\n      pronunciation: 'bg-purple-100 text-purple-800',\r\n      writing: 'bg-yellow-100 text-yellow-800',\r\n      reading: 'bg-indigo-100 text-indigo-800',\r\n      listening: 'bg-pink-100 text-pink-800'\r\n    };\r\n    return colors[type as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  if (sessionLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Initializing AI tutor...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex items-center justify-between h-16\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <div className=\"text-2xl\">{getSessionTypeIcon(sessionType)}</div>\r\n              <div>\r\n                <h1 className=\"text-xl font-semibold text-gray-900\">AI Tutor</h1>\r\n                <p className=\"text-sm text-gray-500 capitalize\">{sessionType} Session</p>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center space-x-4\">\r\n              <span className={`px-3 py-1 text-sm font-medium rounded-full ${getSessionTypeColor(sessionType)}`}>\r\n                {sessionType}\r\n              </span>\r\n              <button\r\n                onClick={endSession}\r\n                className=\"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 transition-colors\"\r\n              >\r\n                End Session\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Chat Area */}\r\n      <div className=\"flex-1 flex flex-col max-w-4xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6\">\r\n        <div className=\"flex-1 bg-white rounded-lg shadow-md flex flex-col\">\r\n          {/* Messages */}\r\n          <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\r\n            {messages.map((message) => (\r\n              <div\r\n                key={message._id}\r\n                className={`flex ${message.role === 'student' ? 'justify-end' : 'justify-start'}`}\r\n              >\r\n                <div\r\n                  className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${\r\n                    message.role === 'student'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-gray-100 text-gray-900'\r\n                  }`}\r\n                >\r\n                  <div className=\"text-sm\">{message.content}</div>\r\n                  \r\n                  {/* Corrections */}\r\n                  {message.corrections && showCorrections && message.corrections.length > 0 && (\r\n                    <div className=\"mt-2 pt-2 border-t border-gray-200\">\r\n                      <div className=\"text-xs font-medium text-gray-600 mb-1\">Corrections:</div>\r\n                      {message.corrections.map((correction, index) => (\r\n                        <div key={index} className=\"text-xs\">\r\n                          <span className=\"line-through text-red-400\">{correction.original}</span>\r\n                          <span className=\"mx-1\">‚Üí</span>\r\n                          <span className=\"text-green-600 font-medium\">{correction.corrected}</span>\r\n                          <div className=\"text-gray-500 mt-1\">{correction.explanation}</div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Suggestions */}\r\n                  {message.suggestions && message.suggestions.length > 0 && (\r\n                    <div className=\"mt-2 pt-2 border-t border-gray-200\">\r\n                      <div className=\"text-xs font-medium text-gray-600 mb-1\">Suggestions:</div>\r\n                      {message.suggestions.map((suggestion, index) => (\r\n                        <div key={index} className=\"text-xs\">\r\n                          <span className=\"font-medium\">{suggestion.suggestion}</span>\r\n                          <div className=\"text-gray-500 mt-1\">{suggestion.explanation}</div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Audio */}\r\n                  {message.audioUrl && (\r\n                    <div className=\"mt-2\">\r\n                      <audio controls className=\"w-full\">\r\n                        <source src={message.audioUrl} type=\"audio/mpeg\" />\r\n                        Your browser does not support the audio element.\r\n                      </audio>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"text-xs opacity-70 mt-1\">\r\n                    {new Date(message.timestamp).toLocaleTimeString()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n\r\n            {isLoading && (\r\n              <div className=\"flex justify-start\">\r\n                <div className=\"bg-gray-100 text-gray-900 max-w-xs lg:max-w-md px-4 py-2 rounded-lg\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"animate-pulse\">ü§ñ</div>\r\n                    <div className=\"flex space-x-1\">\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n\r\n          {/* Input Area */}\r\n          <div className=\"border-t p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"flex-1\">\r\n                <textarea\r\n                  value={inputMessage}\r\n                  onChange={(e) => setInputMessage(e.target.value)}\r\n                  onKeyPress={handleKeyPress}\r\n                  placeholder=\"Type your message...\"\r\n                  rows={1}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n                  disabled={isLoading}\r\n                />\r\n              </div>\r\n              \r\n              <button\r\n                onClick={sendMessage}\r\n                disabled={!inputMessage.trim() || isLoading}\r\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n              >\r\n                Send\r\n              </button>\r\n              \r\n              <button\r\n                onClick={isRecording ? stopRecording : startRecording}\r\n                disabled={isLoading}\r\n                className={`px-4 py-2 rounded-lg transition-colors ${\r\n                  isRecording\r\n                    ? 'bg-red-600 text-white hover:bg-red-700'\r\n                    : 'bg-gray-600 text-white hover:bg-gray-700'\r\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\r\n              >\r\n                {isRecording ? '‚èπÔ∏è' : 'üé§'}\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between mt-2\">\r\n              <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\r\n                <label className=\"flex items-center\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={showCorrections}\r\n                    onChange={(e) => setShowCorrections(e.target.checked)}\r\n                    className=\"mr-2\"\r\n                  />\r\n                  Show corrections\r\n                </label>\r\n              </div>\r\n              \r\n              {session && (\r\n                <div className=\"text-sm text-gray-500\">\r\n                  Session time: {Math.floor((Date.now() - new Date(session.startedAt).getTime()) / 1000 / 60)}m\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Skills Progress */}\r\n        {session && (\r\n          <div className=\"mt-6 bg-white rounded-lg shadow-md p-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Skills Progress</h3>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n              {Object.entries(session.skills).map(([skill, score]) => (\r\n                <div key={skill} className=\"text-center\">\r\n                  <div className=\"text-2xl font-bold text-blue-600\">{score}%</div>\r\n                  <div className=\"text-sm text-gray-600 capitalize\">{skill}</div>\r\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mt-2\">\r\n                    <div\r\n                      className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                      style={{ width: `${score}%` }}\r\n                    ></div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}; ","import React from 'react';\r\nimport Head from 'next/head';\r\nimport { AITutoringInterface } from '../../src/features/aiFeatures/view/AITutoringInterface';\r\nimport { useAuthContext } from '@/context/AuthContext';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect } from 'react';\r\n\r\nexport default function AITutoringPage() {\r\n  const { user, loading } = useAuthContext();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (!loading && !user) {\r\n      router.push('/login');\r\n    }\r\n  }, [user, loading, router]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>AI Tutoring - Verbfy</title>\r\n        <meta name=\"description\" content=\"Start your AI-powered English tutoring session\" />\r\n      </Head>\r\n\r\n      <AITutoringInterface\r\n        sessionType=\"conversation\"\r\n        onComplete={(session) => {\r\n          console.log('AI session completed:', session);\r\n          router.push(`/ai-tutoring/session/${session._id}/results`);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n} "],"names":["window","__NEXT_P","push","__webpack_require__","AITutoringInterface","sessionType","onComplete","param","router","useRouter","user","useAuthContext","session","setSession","useState","messages","setMessages","inputMessage","setInputMessage","isLoading","setIsLoading","sessionLoading","setSessionLoading","isRecording","setIsRecording","showCorrections","setShowCorrections","messagesEndRef","useRef","useEffect","initializeSession","scrollToBottom","current","scrollIntoView","behavior","_aiFeaturesAPI_startTutoringSession","newSession","api","qV","startTutoringSession","call","aiFeaturesAPI","cefrLevel","setTimeout","error","console","sendMessage","trim","userMessage","_id","Date","now","toString","role","content","timestamp","toISOString","messageType","prev","_aiFeaturesAPI_sendTutoringMessage","response","sendTutoringMessage","message","errorMessage","startRecording","audioMessage","audioUrl","endSession","completedSession","endTutoringSession","concat","jsx_runtime","jsx","div","className","jsxs","p","icons","conversation","grammar","pronunciation","writing","reading","listening","h1","span","colors","button","onClick","map","corrections","length","correction","index","original","corrected","explanation","suggestions","suggestion","audio","controls","source","src","type","toLocaleTimeString","style","animationDelay","ref","textarea","value","onChange","e","target","onKeyPress","key","shiftKey","preventDefault","placeholder","rows","disabled","label","input","checked","Math","floor","startedAt","getTime","h3","Object","entries","skills","skill","score","width","AITutoringPage","loading","Fragment","Head","title","meta","name","log"],"sourceRoot":""}