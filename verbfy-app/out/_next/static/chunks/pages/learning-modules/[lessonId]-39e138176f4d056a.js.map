{"version":3,"file":"static/chunks/pages/learning-modules/[lessonId]-39e138176f4d056a.js","mappings":"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","sources":["webpack://_N_E/?1abf","webpack://_N_E/./src/features/learningModules/view/StudentLearningInterface.tsx","webpack://_N_E/./pages/learning-modules/[lessonId].tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/learning-modules/[lessonId]\",\n      function () {\n        return require(\"private-next-pages/learning-modules/[lessonId].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/learning-modules/[lessonId]\"])\n      });\n    }\n  ","import React, { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { VerbfyLesson, LessonAttempt } from '@/types/verbfyLessons';\nimport { verbfyLessonsAPI } from '@/lib/api';\nimport { useAuthContext } from '@/context/AuthContext';\n\ninterface StudentLearningInterfaceProps {\n  lessonId: string;\n  onComplete?: (result: any) => void;\n}\n\nexport const StudentLearningInterface: React.FC<StudentLearningInterfaceProps> = ({\n  lessonId,\n  onComplete\n}) => {\n  const router = useRouter();\n  const { user } = useAuthContext();\n  const [lesson, setLesson] = useState<VerbfyLesson | null>(null);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [currentExercise, setCurrentExercise] = useState(0);\n  const [answers, setAnswers] = useState<{[key: string]: any}>({});\n  const [timeSpent, setTimeSpent] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [attemptId, setAttemptId] = useState<string | null>(null);\n  const [showInstructions, setShowInstructions] = useState(true);\n\n  useEffect(() => {\n    if (lessonId) {\n      fetchLesson();\n    }\n  }, [lessonId]);\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setTimeSpent(prev => prev + 1);\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  const fetchLesson = async () => {\n    try {\n      setLoading(true);\n      const response = await (verbfyLessonsAPI as any).getLesson?.(lessonId);\n      if (response) {\n        // Support both API shapes used in tests\n        const normalized: VerbfyLesson = (response as any).lesson ? {\n          _id: (response as any).lesson.id || lessonId,\n          title: (response as any).lesson.title,\n          description: (response as any).lesson.description || '',\n          lessonType: (response as any).lesson.type || 'VerbfyGrammar',\n          cefrLevel: (response as any).lesson.cefrLevel || 'A1',\n          difficulty: (response as any).lesson.difficulty || 'Beginner',\n          category: '',\n          estimatedDuration: (response as any).lesson.estimatedDuration || 0,\n          content: {\n            instructions: (response as any).lesson.instructions || '',\n            materials: (response as any).lesson.materials || [],\n            exercises: (response as any).lesson.exercises || [],\n          },\n          learningObjectives: [],\n          tags: [],\n          isActive: true,\n          isPremium: false,\n          createdBy: { _id: '', name: '' },\n          averageRating: 0,\n          totalRatings: 0,\n          completionRate: 0,\n          averageCompletionTime: 0,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n        } : (response as any);\n        setLesson(normalized);\n      }\n      const startResponse = await (verbfyLessonsAPI as any).startLesson?.(lessonId);\n      setAttemptId(startResponse?.attemptId || lessonId);\n    } catch (error) {\n      console.error('Error fetching lesson:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAnswer = (answer: any) => {\n    const key = `${currentExercise}`;\n    setAnswers(prev => ({\n      ...prev,\n      [key]: answer\n    }));\n  };\n\n  const handleNext = () => {\n    if (currentExercise < (lesson?.content?.exercises?.length || 0) - 1) {\n      setCurrentExercise(currentExercise + 1);\n    } else {\n      handleSubmit();\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentExercise > 0) {\n      setCurrentExercise(currentExercise - 1);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!attemptId || !lesson) return;\n\n    try {\n      setSubmitting(true);\n      const formattedAnswers = Object.entries(answers).map(([key, answer]) => ({\n        questionIndex: parseInt(key),\n        studentAnswer: answer,\n        timeSpent: 0\n      }));\n      const result = await (verbfyLessonsAPI as any).submitLesson?.(attemptId, {\n        answers: formattedAnswers,\n        timeSpent\n      });\n      if (onComplete) {\n        onComplete(result);\n      } else {\n        router.push(`/verbfy-lessons/${lessonId}/results`);\n      }\n    } catch (error) {\n      console.error('Error submitting lesson:', error);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const formatTime = (seconds: number) => {\n    const minutes = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${minutes}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getProgress = () => {\n    if (!lesson?.content?.exercises) return 0;\n    const totalExercises = lesson.content.exercises.length;\n    const answeredExercises = Object.keys(answers).length;\n    return (answeredExercises / totalExercises) * 100;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading lesson...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lesson) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <p className=\"text-red-600\">Lesson not found</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8\">\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Header */}\n        <div className=\"bg-white rounded-lg shadow-md p-6 mb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-xl font-semibold text-gray-900\">{lesson.title}</h1>\n              <p className=\"text-gray-600 mt-1\">Follow the instructions and complete the exercises</p>\n            </div>\n            <div className=\"text-sm text-gray-500\">\n              <span>Time spent: {formatTime(timeSpent)}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n          {showInstructions ? (\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-2\">Instructions</h2>\n              <p className=\"text-gray-700 mb-4\">{lesson.content?.instructions || 'Read the instructions carefully.'}</p>\n              <button\n                onClick={() => setShowInstructions(false)}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n              >\n                Start Lesson\n              </button>\n            </div>\n          ) : (\n            <div>\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{lesson.title}</h2>\n              {/* Exercise content would go here */}\n              <div className=\"mt-6 flex justify-between\">\n                <button\n                  onClick={handlePrevious}\n                  disabled={currentExercise === 0}\n                  className=\"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50\"\n                >\n                  Previous\n                </button>\n                <button\n                  onClick={handleNext}\n                  className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\"\n                >\n                  {currentExercise < (lesson.content?.exercises?.length || 0) - 1 ? 'Next' : 'Submit'}\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}; ","import React from 'react';\nimport Head from 'next/head';\nimport { StudentLearningInterface } from '../../src/features/learningModules/view/StudentLearningInterface';\nimport { useAuthContext } from '@/context/AuthContext';\nimport { useRouter } from 'next/router';\nimport { useEffect } from 'react';\n\nexport default function TakeLessonPage() {\n  const { user, loading } = useAuthContext();\n  const router = useRouter();\n  const { lessonId } = router.query;\n\n  useEffect(() => {\n    if (!loading && !user) {\n      router.push('/login');\n    }\n  }, [user, loading, router]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user || typeof lessonId !== 'string') {\n    return null;\n  }\n\n  return (\n    <>\n      <Head>\n        <title>Take Lesson - Verbfy</title>\n        <meta name=\"description\" content=\"Start your Verbfy learning lesson\" />\n      </Head>\n\n      <StudentLearningInterface\n        lessonId={lessonId}\n        onComplete={(result: any) => {\n          console.log('Lesson completed:', result);\n          // The interface will handle navigation to results\n        }}\n      />\n    </>\n  );\n} "],"names":["window","__NEXT_P","push","__webpack_require__","StudentLearningInterface","lesson","lessonId","onComplete","param","router","useRouter","user","useAuthContext","setLesson","useState","currentStep","setCurrentStep","currentExercise","setCurrentExercise","answers","setAnswers","timeSpent","setTimeSpent","loading","setLoading","submitting","setSubmitting","attemptId","setAttemptId","showInstructions","setShowInstructions","useEffect","fetchLesson","timer","setInterval","prev","clearInterval","_verbfyLessonsAPI_getLesson","_verbfyLessonsAPI_startLesson","response","api","J0","getLesson","call","verbfyLessonsAPI","normalized","_id","id","title","description","lessonType","type","cefrLevel","difficulty","category","estimatedDuration","content","instructions","materials","exercises","learningObjectives","tags","isActive","isPremium","createdBy","name","averageRating","totalRatings","completionRate","averageCompletionTime","createdAt","Date","toISOString","updatedAt","startResponse","startLesson","error","console","handleSubmit","_verbfyLessonsAPI_submitLesson","formattedAnswers","Object","entries","map","key","answer","questionIndex","parseInt","studentAnswer","result","submitLesson","concat","jsx_runtime","jsx","div","className","jsxs","p","h1","span","secs","Math","floor","seconds","toString","padStart","h2","button","onClick","disabled","length","TakeLessonPage","query","Fragment","Head","meta","log"],"sourceRoot":""}