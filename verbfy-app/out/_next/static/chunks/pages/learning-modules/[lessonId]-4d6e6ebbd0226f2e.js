(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6581],{48773:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/learning-modules/[lessonId]",function(){return s(40045)}])},40045:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var n=s(85893),l=s(67294),i=s(9008),a=s.n(i),r=s(11163),c=s(32798),d=s(36197);let o=e=>{var t,s,i;let{lessonId:a,onComplete:o}=e,u=(0,r.useRouter)(),{user:m}=(0,d.Eu)(),[x,h]=(0,l.useState)(null),[v,f]=(0,l.useState)(0),[g,b]=(0,l.useState)(0),[p,j]=(0,l.useState)({}),[y,N]=(0,l.useState)(0),[w,S]=(0,l.useState)(!0),[_,E]=(0,l.useState)(!1),[I,L]=(0,l.useState)(null),[k,C]=(0,l.useState)(!0);(0,l.useEffect)(()=>{a&&J()},[a]),(0,l.useEffect)(()=>{let e=setInterval(()=>{N(e=>e+1)},1e3);return()=>clearInterval(e)},[]);let J=async()=>{try{var e,t;S(!0);let s=await (null===(e=c.J0.getLesson)||void 0===e?void 0:e.call(c.J0,a));if(s){let e=s.lesson?{_id:s.lesson.id||a,title:s.lesson.title,description:s.lesson.description||"",lessonType:s.lesson.type||"VerbfyGrammar",cefrLevel:s.lesson.cefrLevel||"A1",difficulty:s.lesson.difficulty||"Beginner",category:"",estimatedDuration:s.lesson.estimatedDuration||0,content:{instructions:s.lesson.instructions||"",materials:s.lesson.materials||[],exercises:s.lesson.exercises||[]},learningObjectives:[],tags:[],isActive:!0,isPremium:!1,createdBy:{_id:"",name:""},averageRating:0,totalRatings:0,completionRate:0,averageCompletionTime:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}:s;h(e)}let n=await (null===(t=c.J0.startLesson)||void 0===t?void 0:t.call(c.J0,a));L((null==n?void 0:n.attemptId)||a)}catch(e){}finally{S(!1)}},O=async()=>{if(I&&x)try{var e;E(!0);let t=Object.entries(p).map(e=>{let[t,s]=e;return{questionIndex:parseInt(t),studentAnswer:s,timeSpent:0}}),s=await (null===(e=c.J0.submitLesson)||void 0===e?void 0:e.call(c.J0,I,{answers:t,timeSpent:y}));o?o(s):u.push("/verbfy-lessons/".concat(a,"/results"))}catch(e){}finally{E(!1)}};return w?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading lesson..."})]})}):x?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:x.title}),(0,n.jsx)("p",{className:"text-gray-600 mt-1",children:"Follow the instructions and complete the exercises"})]}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:(0,n.jsxs)("span",{children:["Time spent: ","".concat(Math.floor(y/60),":").concat((y%60).toString().padStart(2,"0"))]})})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:k?(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Instructions"}),(0,n.jsx)("p",{className:"text-gray-700 mb-4",children:(null===(t=x.content)||void 0===t?void 0:t.instructions)||"Read the instructions carefully."}),(0,n.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Start Lesson"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:x.title}),(0,n.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,n.jsx)("button",{onClick:()=>{g>0&&b(g-1)},disabled:0===g,className:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>{var e,t;g<((null==x?void 0:null===(t=x.content)||void 0===t?void 0:null===(e=t.exercises)||void 0===e?void 0:e.length)||0)-1?b(g+1):O()},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:g<((null===(i=x.content)||void 0===i?void 0:null===(s=i.exercises)||void 0===s?void 0:s.length)||0)-1?"Next":"Submit"})]})]})})]})}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("p",{className:"text-red-600",children:"Lesson not found"})})})};function u(){let{user:e,loading:t}=(0,d.Eu)(),s=(0,r.useRouter)(),{lessonId:i}=s.query;return((0,l.useEffect)(()=>{t||e||s.push("/login")},[e,t,s]),t)?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):e&&"string"==typeof i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"Take Lesson - Verbfy"}),(0,n.jsx)("meta",{name:"description",content:"Start your Verbfy learning lesson"})]}),(0,n.jsx)(o,{lessonId:i,onComplete:e=>{}})]}):null}}},function(e){e.O(0,[2138,9226,9496,8484,437,5823,2244,6235,5323,747,3365,8638,9806,7093,8510,8424,8639,7855,7446,2169,8308,1408,6259,4657,8212,1493,2888,5514,179],function(){return e(e.s=48773)}),_N_E=e.O()}]);