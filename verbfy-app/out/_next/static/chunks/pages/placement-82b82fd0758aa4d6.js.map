{"version":3,"file":"static/chunks/pages/placement-82b82fd0758aa4d6.js","mappings":"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","sources":["webpack://_N_E/?64f6","webpack://_N_E/./pages/placement/index.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/placement\",\n      function () {\n        return require(\"private-next-pages/placement/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/placement\"])\n      });\n    }\n  ","import React, { useEffect, useState } from 'react';\r\nimport Head from 'next/head';\r\nimport Link from 'next/link';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\nimport api, { cefrTestsAPI } from '@/lib/api';\r\nimport { useI18n } from '@/lib/i18n';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\nexport default function PlacementPage() {\r\n  const { t, locale } = useI18n();\r\n  const { user } = useAuth();\r\n  const [recommendation, setRecommendation] = useState<string | null>(null);\r\n  const [tests, setTests] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let abort = false;\r\n    const run = async () => {\r\n      try {\r\n        if (!user) {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        const [rec, list] = await Promise.all([\r\n          cefrTestsAPI.getPlacementRecommendation().catch(() => null),\r\n          cefrTestsAPI.getTests({ testType: 'placement' }).catch(() => ({ data: [] })),\r\n        ]);\r\n        if (!abort) {\r\n          if (rec && (rec as any).recommendation) setRecommendation((rec as any).recommendation);\r\n          let arr = Array.isArray((list as any)?.tests) ? (list as any).tests : Array.isArray((list as any)?.data) ? (list as any).data : (Array.isArray(list) ? list : []);\r\n          if (!arr || arr.length === 0) {\r\n            try {\r\n              // Use explicit endpoint that guarantees four placement tests\r\n              const ensured = await api.get('/api/cefr-tests/placement/all');\r\n              arr = Array.isArray((ensured.data as any)?.tests) ? (ensured.data as any).tests : [];\r\n            } catch {}\r\n          }\r\n          setTests(arr || []);\r\n        }\r\n      } finally {\r\n        if (!abort) setLoading(false);\r\n      }\r\n    };\r\n    run();\r\n    return () => { abort = true; };\r\n  }, [user]);\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['student', 'teacher']}>\r\n      <div className=\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-10\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-bold text-gray-900 mb-4\">{locale === 'tr' ? 'Seviye Tespit Sınavı' : 'Placement Test'}</h1>\r\n        {!user && (\r\n          <div className=\"mb-6 bg-amber-50 border border-amber-200 text-amber-800 rounded-xl p-4\">\r\n            {locale==='tr' ? 'Bu sayfa yalnızca kayıtlı kullanıcılara açıktır. Ücretsiz seviye testi için ' : 'This page is only available to registered users. For the free level test go to '}\r\n            <Link href=\"/level-test/free\" className=\"font-semibold underline\">{locale==='tr' ? 'Ücretsiz Seviye Testi' : 'Free Level Test'}</Link>.\r\n          </div>\r\n        )}\r\n        <p className=\"text-gray-600 mb-6\">\r\n          {locale === 'tr'\r\n            ? 'İlk girişte CEFR seviyenizi belirlemek için hızlı bir seviye tespit sınavı çözün. Sonuçlar kişiselleştirilmiş yol haritanızı oluşturmakta kullanılacaktır.'\r\n            : 'On your first visit, take a quick placement test to determine your CEFR level. The result will be used to personalize your learning path.'}\r\n        </p>\r\n\r\n        {loading ? (\r\n          <p className=\"text-gray-600\">{locale === 'tr' ? 'Yükleniyor...' : 'Loading...'}</p>\r\n        ) : (\r\n          <>\r\n            {recommendation && (\r\n              <div className=\"mb-6 bg-blue-50 border border-blue-200 rounded-xl p-4\">\r\n                <p className=\"font-semibold\">\r\n                  {locale === 'tr' ? 'Önerilen başlangıç seviyesi: ' : 'Recommended starting level: '}\r\n                  <span className=\"text-blue-700\">{recommendation}</span>\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-4\">\r\n              {tests.length > 0 ? (\r\n                tests.map((test: any) => (\r\n                  <div key={test._id || test.id} className=\"p-4 rounded-xl border border-gray-200 flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"font-semibold text-gray-900\">{test.title || 'CEFR Placement'}</p>\r\n                      <p className=\"text-sm text-gray-600\">{test.description || (locale === 'tr' ? 'Seviyenizi ölçün' : 'Measure your level')}</p>\r\n                    </div>\r\n                    <Link href={`/cefr-tests/${test._id || test.id}`} className=\"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700\">\r\n                      {locale === 'tr' ? 'Sınavı Başlat' : 'Start Test'}\r\n                    </Link>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-gray-600\">{locale === 'tr' ? 'Uygun sınav bulunamadı.' : 'No placement test available.'}</p>\r\n              )}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n}\r\n\r\n\r\n"],"names":["window","__NEXT_P","push","__webpack_require__","PlacementPage","t","locale","useI18n","user","useAuth","recommendation","setRecommendation","useState","tests","setTests","loading","setLoading","useEffect","abort","run","rec","list","Promise","all","cefrTestsAPI","getPlacementRecommendation","catch","getTests","testType","data","arr","Array","isArray","length","ensured","api","get","_ensured_data","e","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","DashboardLayout","allowedRoles","jsxs","div","className","h1","Link","href","p","Fragment","span","map","test","title","description","concat","_id","id"],"sourceRoot":""}