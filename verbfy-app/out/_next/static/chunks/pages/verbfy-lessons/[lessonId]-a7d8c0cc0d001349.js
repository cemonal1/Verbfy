(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2917],{16087:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verbfy-lessons/[lessonId]",function(){return t(13525)}])},13525:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var l=t(85893),a=t(67294),n=t(11163),r=t(9008),i=t.n(r),c=t(11088),o=t(32798),d=t(36197),u=t(56158);function x(){let e=(0,n.useRouter)(),{lessonId:s}=e.query,{user:t}=(0,d.Eu)(),{success:r,error:x}=(0,u.pm)(),[m,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[g,y]=(0,a.useState)(!0),[f,j]=(0,a.useState)(0),[N,v]=(0,a.useState)({}),[w,D]=(0,a.useState)(0),[C,k]=(0,a.useState)(!1),[L,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{s&&"string"==typeof s&&_()},[s]),(0,a.useEffect)(()=>{let e=setInterval(()=>{D(e=>e+1)},1e3);return()=>clearInterval(e)},[]);let _=async()=>{try{y(!0);let e=await o.J0.getLesson(s);h(e.lesson);let t=await o.J0.startLesson(s);b(t.attempt)}catch(s){x("Failed to load lesson"),e.push("/verbfy-lessons")}finally{y(!1)}},E=(e,s)=>{v(t=>({...t,[e]:s}))},A=async()=>{if(p){k(!0);try{await o.J0.submitLesson(p._id,{answers:N,timeSpent:w}),r("Lesson completed successfully!"),e.push("/verbfy-lessons/".concat(s,"/results"))}catch(e){x("Failed to submit lesson")}finally{k(!1)}}};if(g)return(0,l.jsx)(c.Z,{allowedRoles:["student","teacher","admin"],children:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})});if(!m||!p)return(0,l.jsx)(c.Z,{allowedRoles:["student","teacher","admin"],children:(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Lesson not found"}),(0,l.jsx)("button",{onClick:()=>e.push("/verbfy-lessons"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Back to Lessons"})]})});let V=m.content.exercises[f];return(0,l.jsxs)(c.Z,{allowedRoles:["student","teacher","admin"],children:[(0,l.jsx)(i(),{children:(0,l.jsxs)("title",{children:[m.title," - Verbfy"]})}),(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("div",{className:"bg-white border-b sticky top-0 z-10",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:m.title}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[{VerbfyGrammar:"\uD83D\uDCDD",VerbfyRead:"\uD83D\uDCD6",VerbfyWrite:"✍️",VerbfySpeak:"\uD83C\uDFA4",VerbfyListen:"\uD83C\uDFA7",VerbfyVocab:"\uD83D\uDCDA"}[m.lessonType]||"\uD83D\uDCDA"," ",m.lessonType," •",m.cefrLevel," • ",m.difficulty," • Step ",f+1," of ",m.content.exercises.length]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Time: ","".concat(Math.floor(w/60),":").concat((w%60).toString().padStart(2,"0"))]}),(0,l.jsx)("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Complete Lesson"})]})]}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(m?(f+1)/m.content.exercises.length*100:0,"%")}})})})]})}),(0,l.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-8",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,l.jsx)("div",{className:"lg:col-span-3",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[0===f&&(0,l.jsxs)("div",{className:"mb-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB Lesson Instructions"}),(0,l.jsx)("div",{className:"prose prose-sm text-gray-700",children:(0,l.jsx)("p",{children:m.content.instructions})}),m.learningObjectives.length>0&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Learning Objectives:"}),(0,l.jsx)("ul",{className:"space-y-1",children:m.learningObjectives.map((e,s)=>(0,l.jsxs)("li",{className:"text-sm text-gray-600 flex items-start",children:[(0,l.jsx)("span",{className:"mr-2",children:"•"}),e]},s))})]})]}),m.content.materials.length>0&&(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCDA Learning Materials"}),(0,l.jsx)("div",{className:"space-y-4",children:m.content.materials.map((e,s)=>(0,l.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsxs)("span",{className:"mr-2",children:["text"===e.type&&"\uD83D\uDCC4","audio"===e.type&&"\uD83C\uDFB5","video"===e.type&&"\uD83C\uDFA5","image"===e.type&&"\uD83D\uDDBC️"]}),(0,l.jsx)("span",{className:"font-medium text-gray-900 capitalize",children:e.type})]}),"text"===e.type&&(0,l.jsx)("div",{className:"prose prose-sm text-gray-700",children:(0,l.jsx)("p",{children:e.content})}),"audio"===e.type&&(0,l.jsxs)("audio",{controls:!0,className:"w-full",children:[(0,l.jsx)("source",{src:e.fileUrl,type:"audio/mpeg"}),"Your browser does not support the audio element."]}),"video"===e.type&&(0,l.jsxs)("video",{controls:!0,className:"w-full rounded",children:[(0,l.jsx)("source",{src:e.fileUrl,type:"video/mp4"}),"Your browser does not support the video element."]}),"image"===e.type&&(0,l.jsx)("img",{src:e.fileUrl||e.content,alt:"Lesson material",className:"w-full rounded"})]},s))})]}),V&&(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Exercise ",f+1," of ",m.content.exercises.length]}),(0,l.jsx)("span",{className:"text-sm text-gray-500 capitalize",children:V.type})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("p",{className:"text-lg text-gray-900",children:V.question})}),(0,l.jsxs)("div",{className:"space-y-3",children:["multiple-choice"===V.type&&V.options&&V.options.map((e,s)=>(0,l.jsxs)("label",{className:"flex items-center p-4 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"exercise-".concat(f),value:e,checked:N[f]===e,onChange:e=>E(f,e.target.value),className:"mr-3"}),(0,l.jsx)("span",{className:"text-gray-900",children:e})]},s)),"fill-blank"===V.type&&(0,l.jsx)("input",{type:"text",value:N[f]||"",onChange:e=>E(f,e.target.value),placeholder:"Enter your answer...",className:"w-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),"essay"===V.type&&(0,l.jsx)("textarea",{value:N[f]||"",onChange:e=>E(f,e.target.value),placeholder:"Type your answer here...",className:"w-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),"matching"===V.type&&V.options&&(0,l.jsx)("div",{className:"space-y-3",children:V.options.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("span",{className:"text-sm font-medium text-gray-700 w-20",children:[s+1,"."]}),(0,l.jsx)("input",{type:"text",value:N["".concat(f,"-").concat(s)]||"",onChange:e=>E("".concat(f,"-").concat(s),e.target.value),placeholder:"Match with...",className:"flex-1 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})]},s))})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t",children:[(0,l.jsx)("button",{onClick:()=>{f>0&&j(f-1)},disabled:0===f,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),(0,l.jsx)("button",{onClick:()=>{f<m.content.exercises.length-1&&j(f+1)},disabled:f===m.content.exercises.length-1,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})}),(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-24",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Exercise Navigator"}),(0,l.jsx)("div",{className:"space-y-2",children:m.content.exercises.map((e,s)=>{let t=void 0!==N[s],a=s===f;return(0,l.jsxs)("button",{onClick:()=>j(s),className:"w-full p-3 text-left rounded-lg border transition-colors ".concat(a?"bg-blue-600 text-white border-blue-600":t?"bg-green-100 text-green-800 border-green-300 hover:bg-green-200":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"font-medium",children:["Exercise ",s+1]}),(0,l.jsx)("span",{className:"text-xs capitalize",children:e.type})]}),t&&!a&&(0,l.jsx)("div",{className:"text-xs mt-1",children:"✓ Answered"})]},s)})})]})})]})}),L&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Complete Lesson?"}),(0,l.jsxs)("p",{className:"text-gray-600 mb-6",children:["You have completed ",Object.keys(N).length," out of ",m.content.exercises.length," exercises. Are you sure you want to complete this lesson?"]}),(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)("button",{onClick:()=>S(!1),className:"flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Continue Lesson"}),(0,l.jsx)("button",{onClick:A,disabled:C,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors",children:C?"Submitting...":"Complete Lesson"})]})]})})]})]})}}},function(e){e.O(0,[2138,9226,9496,8484,437,1883,7,747,3365,8638,9806,7093,8510,8424,8639,7855,7446,2169,8308,1408,6259,4657,8212,1088,5522,1493,2888,5514,179],function(){return e(e.s=16087)}),_N_E=e.O()}]);