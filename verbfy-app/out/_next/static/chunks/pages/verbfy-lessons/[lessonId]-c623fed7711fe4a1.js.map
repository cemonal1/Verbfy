{"version":3,"file":"static/chunks/pages/verbfy-lessons/[lessonId]-c623fed7711fe4a1.js","mappings":"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","sources":["webpack://_N_E/?da88","webpack://_N_E/./pages/verbfy-lessons/[lessonId].tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/verbfy-lessons/[lessonId]\",\n      function () {\n        return require(\"private-next-pages/verbfy-lessons/[lessonId].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/verbfy-lessons/[lessonId]\"])\n      });\n    }\n  ","import React, { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\nimport { verbfyLessonsAPI } from '@/lib/api';\r\nimport { VerbfyLesson, LessonAttempt } from '@/types/verbfyLessons';\r\nimport { useAuthContext } from '@/context/AuthContext';\r\nimport { useToast } from '@/components/common/Toast';\r\n\r\nexport default function LessonTakingPage() {\r\n  const router = useRouter();\r\n  const { lessonId } = router.query;\r\n  const { user } = useAuthContext();\r\n  const { success, error } = useToast();\r\n  \r\n  const [lesson, setLesson] = useState<VerbfyLesson | null>(null);\r\n  const [attempt, setAttempt] = useState<LessonAttempt | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [answers, setAnswers] = useState<{ [key: string]: any }>({});\r\n  const [timeSpent, setTimeSpent] = useState(0);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showConfirmSubmit, setShowConfirmSubmit] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (lessonId && typeof lessonId === 'string') {\r\n      loadLesson();\r\n    }\r\n  }, [lessonId]);\r\n\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      setTimeSpent(prev => prev + 1);\r\n    }, 1000);\r\n\r\n    return () => clearInterval(timer);\r\n  }, []);\r\n\r\n  const loadLesson = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const lessonResponse = await verbfyLessonsAPI.getLesson(lessonId as string);\r\n      setLesson(lessonResponse.lesson);\r\n      \r\n      // Start lesson attempt\r\n      const attemptResponse = await verbfyLessonsAPI.startLesson(lessonId as string);\r\n      setAttempt(attemptResponse.attempt);\r\n    } catch (err) {\r\n      error('Failed to load lesson');\r\n      console.error('Error loading lesson:', err);\r\n      router.push('/verbfy-lessons');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAnswerChange = (exerciseIndex: string | number, answer: any) => {\r\n    setAnswers(prev => ({\r\n      ...prev,\r\n      [exerciseIndex]: answer\r\n    }));\r\n  };\r\n\r\n  const handleNextStep = () => {\r\n    if (currentStep < lesson!.content.exercises.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    }\r\n  };\r\n\r\n  const handlePreviousStep = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!attempt) return;\r\n    \r\n    setIsSubmitting(true);\r\n    try {\r\n      const response = await verbfyLessonsAPI.submitLesson(attempt._id, {\r\n        answers,\r\n        timeSpent\r\n      });\r\n      \r\n      success('Lesson completed successfully!');\r\n      router.push(`/verbfy-lessons/${lessonId}/results`);\r\n    } catch (err) {\r\n      error('Failed to submit lesson');\r\n      console.error('Error submitting lesson:', err);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const minutes = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${minutes}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const getProgressPercentage = () => {\r\n    if (!lesson) return 0;\r\n    return ((currentStep + 1) / lesson.content.exercises.length) * 100;\r\n  };\r\n\r\n  const getLessonTypeIcon = (lessonType: string) => {\r\n    const icons = {\r\n      'VerbfyGrammar': '📝',\r\n      'VerbfyRead': '📖',\r\n      'VerbfyWrite': '✍️',\r\n      'VerbfySpeak': '🎤',\r\n      'VerbfyListen': '🎧',\r\n      'VerbfyVocab': '📚'\r\n    };\r\n    return icons[lessonType as keyof typeof icons] || '📚';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['student', 'teacher', 'admin']}>\r\n        <div className=\"flex items-center justify-center h-64\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n        </div>\r\n      </DashboardLayout>\r\n    );\r\n  }\r\n\r\n  if (!lesson || !attempt) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['student', 'teacher', 'admin']}>\r\n        <div className=\"text-center py-12\">\r\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Lesson not found</h2>\r\n          <button\r\n            onClick={() => router.push('/verbfy-lessons')}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\r\n          >\r\n            Back to Lessons\r\n          </button>\r\n        </div>\r\n      </DashboardLayout>\r\n    );\r\n  }\r\n\r\n  const currentExercise = lesson.content.exercises[currentStep];\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['student', 'teacher', 'admin']}>\r\n      <Head>\r\n        <title>{lesson.title} - Verbfy</title>\r\n      </Head>\r\n\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        {/* Header with Progress */}\r\n        <div className=\"bg-white border-b sticky top-0 z-10\">\r\n          <div className=\"max-w-7xl mx-auto px-6 py-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h1 className=\"text-xl font-semibold text-gray-900\">{lesson.title}</h1>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {getLessonTypeIcon(lesson.lessonType)} {lesson.lessonType} • \r\n                  {lesson.cefrLevel} • {lesson.difficulty} • \r\n                  Step {currentStep + 1} of {lesson.content.exercises.length}\r\n                </p>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center space-x-4\">\r\n                <div className=\"text-sm text-gray-600\">\r\n                  Time: {formatTime(timeSpent)}\r\n                </div>\r\n                \r\n                <button\r\n                  onClick={() => setShowConfirmSubmit(true)}\r\n                  className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors\"\r\n                >\r\n                  Complete Lesson\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Progress Bar */}\r\n            <div className=\"mt-4\">\r\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                <div \r\n                  className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                  style={{ width: `${getProgressPercentage()}%` }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"max-w-4xl mx-auto px-6 py-8\">\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n            {/* Main Content */}\r\n            <div className=\"lg:col-span-3\">\r\n              <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n                {/* Lesson Instructions */}\r\n                {currentStep === 0 && (\r\n                  <div className=\"mb-8 p-6 bg-blue-50 rounded-lg border border-blue-200\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">📋 Lesson Instructions</h3>\r\n                    <div className=\"prose prose-sm text-gray-700\">\r\n                      <p>{lesson.content.instructions}</p>\r\n                    </div>\r\n                    \r\n                    {lesson.learningObjectives.length > 0 && (\r\n                      <div className=\"mt-4\">\r\n                        <h4 className=\"font-medium text-gray-900 mb-2\">Learning Objectives:</h4>\r\n                        <ul className=\"space-y-1\">\r\n                          {lesson.learningObjectives.map((objective, index) => (\r\n                            <li key={index} className=\"text-sm text-gray-600 flex items-start\">\r\n                              <span className=\"mr-2\">•</span>\r\n                              {objective}\r\n                            </li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n\r\n                {/* Materials */}\r\n                {lesson.content.materials.length > 0 && (\r\n                  <div className=\"mb-8\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">📚 Learning Materials</h3>\r\n                    <div className=\"space-y-4\">\r\n                      {lesson.content.materials.map((material, index) => (\r\n                        <div key={index} className=\"p-4 border rounded-lg\">\r\n                          <div className=\"flex items-center mb-2\">\r\n                            <span className=\"mr-2\">\r\n                              {material.type === 'text' && '📄'}\r\n                              {material.type === 'audio' && '🎵'}\r\n                              {material.type === 'video' && '🎥'}\r\n                              {material.type === 'image' && '🖼️'}\r\n                            </span>\r\n                            <span className=\"font-medium text-gray-900 capitalize\">{material.type}</span>\r\n                          </div>\r\n                          \r\n                          {material.type === 'text' && (\r\n                            <div className=\"prose prose-sm text-gray-700\">\r\n                              <p>{material.content}</p>\r\n                            </div>\r\n                          )}\r\n                          \r\n                          {material.type === 'audio' && (\r\n                            <audio controls className=\"w-full\">\r\n                              <source src={material.fileUrl} type=\"audio/mpeg\" />\r\n                              Your browser does not support the audio element.\r\n                            </audio>\r\n                          )}\r\n                          \r\n                          {material.type === 'video' && (\r\n                            <video controls className=\"w-full rounded\">\r\n                              <source src={material.fileUrl} type=\"video/mp4\" />\r\n                              Your browser does not support the video element.\r\n                            </video>\r\n                          )}\r\n                          \r\n                          {material.type === 'image' && (\r\n                            <img \r\n                              src={material.fileUrl || material.content} \r\n                              alt=\"Lesson material\"\r\n                              className=\"w-full rounded\"\r\n                            />\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Current Exercise */}\r\n                {currentExercise && (\r\n                  <div className=\"mb-8\">\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                        Exercise {currentStep + 1} of {lesson.content.exercises.length}\r\n                      </h3>\r\n                      <span className=\"text-sm text-gray-500 capitalize\">{currentExercise.type}</span>\r\n                    </div>\r\n                    \r\n                    <div className=\"mb-6\">\r\n                      <p className=\"text-lg text-gray-900\">{currentExercise.question}</p>\r\n                    </div>\r\n\r\n                    {/* Answer Options */}\r\n                    <div className=\"space-y-3\">\r\n                      {currentExercise.type === 'multiple-choice' && currentExercise.options && (\r\n                        currentExercise.options.map((option, index) => (\r\n                          <label key={index} className=\"flex items-center p-4 border rounded-lg hover:bg-gray-50 cursor-pointer\">\r\n                            <input\r\n                              type=\"radio\"\r\n                              name={`exercise-${currentStep}`}\r\n                              value={option}\r\n                              checked={answers[currentStep] === option}\r\n                              onChange={(e) => handleAnswerChange(currentStep, e.target.value)}\r\n                              className=\"mr-3\"\r\n                            />\r\n                            <span className=\"text-gray-900\">{option}</span>\r\n                          </label>\r\n                        ))\r\n                      )}\r\n                      \r\n                      {currentExercise.type === 'fill-blank' && (\r\n                        <input\r\n                          type=\"text\"\r\n                          value={answers[currentStep] || ''}\r\n                          onChange={(e) => handleAnswerChange(currentStep, e.target.value)}\r\n                          placeholder=\"Enter your answer...\"\r\n                          className=\"w-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        />\r\n                      )}\r\n                      \r\n                      {currentExercise.type === 'essay' && (\r\n                        <textarea\r\n                          value={answers[currentStep] || ''}\r\n                          onChange={(e) => handleAnswerChange(currentStep, e.target.value)}\r\n                          placeholder=\"Type your answer here...\"\r\n                          className=\"w-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                          rows={4}\r\n                        />\r\n                      )}\r\n                      \r\n                      {currentExercise.type === 'matching' && currentExercise.options && (\r\n                        <div className=\"space-y-3\">\r\n                          {currentExercise.options.map((option, index) => (\r\n                            <div key={index} className=\"flex items-center space-x-3\">\r\n                              <span className=\"text-sm font-medium text-gray-700 w-20\">\r\n                                {index + 1}.\r\n                              </span>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={answers[`${currentStep}-${index}`] || ''}\r\n                                onChange={(e) => handleAnswerChange(`${currentStep}-${index}`, e.target.value)}\r\n                                placeholder=\"Match with...\"\r\n                                className=\"flex-1 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                              />\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Navigation */}\r\n                <div className=\"flex items-center justify-between pt-6 border-t\">\r\n                  <button\r\n                    onClick={handlePreviousStep}\r\n                    disabled={currentStep === 0}\r\n                    className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    Previous\r\n                  </button>\r\n                  \r\n                  <button\r\n                    onClick={handleNextStep}\r\n                    disabled={currentStep === lesson.content.exercises.length - 1}\r\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    Next\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Sidebar - Exercise Navigator */}\r\n            <div className=\"lg:col-span-1\">\r\n              <div className=\"bg-white rounded-lg shadow-sm border p-6 sticky top-24\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Exercise Navigator</h3>\r\n                \r\n                <div className=\"space-y-2\">\r\n                  {lesson.content.exercises.map((exercise, index) => {\r\n                    const isAnswered = answers[index] !== undefined;\r\n                    const isCurrent = index === currentStep;\r\n                    \r\n                    return (\r\n                      <button\r\n                        key={index}\r\n                        onClick={() => setCurrentStep(index)}\r\n                        className={`w-full p-3 text-left rounded-lg border transition-colors ${\r\n                          isCurrent \r\n                            ? 'bg-blue-600 text-white border-blue-600' \r\n                            : isAnswered \r\n                              ? 'bg-green-100 text-green-800 border-green-300 hover:bg-green-200' \r\n                              : 'bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <span className=\"font-medium\">Exercise {index + 1}</span>\r\n                          <span className=\"text-xs capitalize\">{exercise.type}</span>\r\n                        </div>\r\n                        {isAnswered && !isCurrent && (\r\n                          <div className=\"text-xs mt-1\">✓ Answered</div>\r\n                        )}\r\n                      </button>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Confirm Submit Modal */}\r\n        {showConfirmSubmit && (\r\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n            <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Complete Lesson?</h3>\r\n              <p className=\"text-gray-600 mb-6\">\r\n                You have completed {Object.keys(answers).length} out of {lesson.content.exercises.length} exercises. \r\n                Are you sure you want to complete this lesson?\r\n              </p>\r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={() => setShowConfirmSubmit(false)}\r\n                  className=\"flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors\"\r\n                >\r\n                  Continue Lesson\r\n                </button>\r\n                <button\r\n                  onClick={handleSubmit}\r\n                  disabled={isSubmitting}\r\n                  className=\"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors\"\r\n                >\r\n                  {isSubmitting ? 'Submitting...' : 'Complete Lesson'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n} "],"names":["window","__NEXT_P","push","__webpack_require__","LessonTakingPage","router","useRouter","lessonId","query","user","useAuthContext","success","error","useToast","lesson","setLesson","useState","attempt","setAttempt","loading","setLoading","currentStep","setCurrentStep","answers","setAnswers","timeSpent","setTimeSpent","isSubmitting","setIsSubmitting","showConfirmSubmit","setShowConfirmSubmit","useEffect","loadLesson","timer","setInterval","prev","clearInterval","lessonResponse","verbfyLessonsAPI","getLesson","attemptResponse","startLesson","err","console","handleAnswerChange","exerciseIndex","answer","handleSubmit","submitLesson","_id","concat","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","DashboardLayout","allowedRoles","div","className","jsxs","h2","button","onClick","currentExercise","content","exercises","Head","title","h1","p","icons","lessonType","cefrLevel","difficulty","length","secs","Math","floor","seconds","toString","padStart","style","width","h3","instructions","learningObjectives","h4","ul","map","objective","index","li","span","materials","material","type","audio","controls","source","src","fileUrl","video","img","alt","question","options","option","label","input","name","value","checked","onChange","e","target","placeholder","textarea","rows","disabled","exercise","isAnswered","undefined","isCurrent","Object","keys"],"sourceRoot":""}