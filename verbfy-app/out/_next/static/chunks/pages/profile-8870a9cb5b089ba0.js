(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{56896:function(e,i,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return l(11109)}])},11109:function(e,i,l){"use strict";l.r(i);var a=l(85893),s=l(67294),t=l(11088),n=l(36197),r=l(32798);i.default=function(){let{user:e,refreshUser:i}=(0,n.aC)(),[l,o]=(0,s.useState)({name:"",email:"",bio:"",phone:"",specialties:"",experience:"",education:"",certifications:"",cvUrl:"",introVideoUrl:""}),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!1),[p,v]=(0,s.useState)(""),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(e){var i;o({name:e.name||"",email:e.email||"",bio:e.bio||"",phone:e.phone||"",specialties:Array.isArray(e.specialties)?e.specialties.join(", "):"",experience:null!==(i=e.experience)&&void 0!==i?i:"",education:e.education||"",certifications:Array.isArray(e.certifications)?e.certifications.join(", "):"",cvUrl:e.cvUrl||"",introVideoUrl:e.introVideoUrl||""})}},[e]);let b=async e=>{e.preventDefault();try{d(!0),await r.TV.updateProfile({...l,specialties:"string"==typeof l.specialties?l.specialties.split(",").map(e=>e.trim()).filter(Boolean):l.specialties,certifications:"string"==typeof l.certifications?l.certifications.split(",").map(e=>e.trim()).filter(Boolean):l.certifications,experience:l.experience?Number(l.experience):void 0}),await i()}finally{d(!1)}},h=async e=>{var l;let a=null===(l=e.target.files)||void 0===l?void 0:l[0];if(a)try{m(!0),await r.TV.uploadAvatar(a),await i()}finally{m(!1),e.target.value=""}},j=(null==e?void 0:e.profileImage)||(null==e?void 0:e.avatar)||"/images/default-avatar.png";return(0,a.jsx)(t.Z,{allowedRoles:["teacher","student"],title:"Profile",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center sm:items-start",children:[(0,a.jsx)("div",{className:"relative w-28 h-28 rounded-full overflow-hidden ring-2 ring-blue-100",children:(0,a.jsx)("img",{src:j,alt:"Avatar",className:"w-full h-full object-cover"})}),(0,a.jsx)("button",{onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},className:"mt-3 px-3 py-1.5 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700",children:u?"Uploading...":"Change Avatar"}),(0,a.jsx)("input",{ref:g,type:"file",accept:"image/*",className:"hidden",onChange:h})]}),(0,a.jsxs)("form",{onSubmit:b,className:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"sm:col-span-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3 bg-gray-50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Email verification"}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:(null==e?void 0:e.emailVerified)?"Your email is verified.":"Your email is not verified."}),p&&(0,a.jsx)("div",{className:"text-xs text-gray-700 mt-1",children:p})]}),!(null==e?void 0:e.emailVerified)&&(0,a.jsx)("button",{type:"button",onClick:async()=>{var e,i,l;try{f(!0),v("");let i=await r.ZP.post("/api/auth/verify-email/request");v((null===(e=i.data)||void 0===e?void 0:e.message)||"Verification email sent if your email is eligible.")}catch(e){v((null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)||"Failed to send verification email")}finally{f(!1)}},disabled:x,className:"inline-flex items-center rounded-md bg-green-600 px-3 py-1.5 text-white text-sm hover:bg-green-700 disabled:opacity-50",children:x?"Sendingâ€¦":"Resend verification"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Name"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.name,onChange:e=>o({...l,name:e.target.value}),required:!0})]}),(0,a.jsx)("div",{className:"sm:col-span-2 border-t pt-4 mt-2",children:(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Teacher Application Details"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Specialties (comma-separated)"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.specialties,onChange:e=>o({...l,specialties:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Experience (years)"}),(0,a.jsx)("input",{type:"number",min:0,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.experience,onChange:e=>o({...l,experience:e.target.value})})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Education"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.education,onChange:e=>o({...l,education:e.target.value})})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Certifications (comma-separated)"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.certifications,onChange:e=>o({...l,certifications:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"CV URL"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.cvUrl,onChange:e=>o({...l,cvUrl:e.target.value}),placeholder:"https://..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Intro Video URL"}),(0,a.jsx)("input",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.introVideoUrl,onChange:e=>o({...l,introVideoUrl:e.target.value}),placeholder:"https://..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.email,onChange:e=>o({...l,email:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Bio"}),(0,a.jsx)("textarea",{className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,value:l.bio,onChange:e=>o({...l,bio:e.target.value})})]}),(0,a.jsx)("div",{className:"sm:col-span-2 flex justify-end",children:(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700",disabled:c,children:c?"Saving...":"Save Changes"})})]})]})})})})}}},function(e){e.O(0,[1216,1088,2888,179],function(){return e(e.s=56896)}),_N_E=e.O()}]);