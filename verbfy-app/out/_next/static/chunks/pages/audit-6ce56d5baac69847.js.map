{"version":3,"file":"static/chunks/pages/audit-6ce56d5baac69847.js","mappings":"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","sources":["webpack://_N_E/?ea9f","webpack://_N_E/./src/components/audit/AuditLogViewer.tsx","webpack://_N_E/./pages/audit/index.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/audit\",\n      function () {\n        return require(\"private-next-pages/audit/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/audit\"])\n      });\n    }\n  ","import React, { useState, useEffect } from 'react';\r\nimport { AuditLog, AuditLogFilters, AuditLogStats } from '@/types/audit';\r\nimport api from '@/lib/api';\r\n\r\ninterface AuditLogViewerProps {\r\n  organizationId?: string;\r\n}\r\n\r\nexport default function AuditLogViewer({ organizationId }: AuditLogViewerProps) {\r\n  const [logs, setLogs] = useState<AuditLog[]>([]);\r\n  const [stats, setStats] = useState<AuditLogStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [selectedLog, setSelectedLog] = useState<AuditLog | null>(null);\r\n  const [filters, setFilters] = useState<AuditLogFilters>({\r\n    organizationId,\r\n    page: 1,\r\n    limit: 50,\r\n    sortBy: 'timestamp',\r\n    sortOrder: 'desc'\r\n  });\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchAuditLogs();\r\n    fetchAuditStats();\r\n  }, [filters, organizationId]);\r\n\r\n  const fetchAuditLogs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await api.get('/api/audit-logs', { params: filters });\r\n      setLogs(response.data.data);\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.message || 'Failed to fetch audit logs');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchAuditStats = async () => {\r\n    try {\r\n      const response = await api.get('/api/audit-logs/stats', { params: { organizationId } });\r\n      setStats(response.data.data);\r\n    } catch (err: any) {\r\n      console.error('Failed to fetch audit stats:', err);\r\n    }\r\n  };\r\n\r\n  const handleFilterChange = (key: keyof AuditLogFilters, value: any) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [key]: value,\r\n      page: 1 // Reset to first page when filters change\r\n    }));\r\n  };\r\n\r\n  const handleSearch = () => {\r\n    handleFilterChange('search', searchTerm);\r\n  };\r\n\r\n  const handleExport = async (format: 'csv' | 'json' | 'pdf') => {\r\n    try {\r\n      const response = await api.post('/api/audit-logs/export', {\r\n        filters,\r\n        format,\r\n        includeDetails: true,\r\n        includeHeaders: true\r\n      });\r\n      \r\n      // Create download link\r\n      const link = document.createElement('a');\r\n      link.href = response.data.data.downloadUrl;\r\n      link.download = `audit-logs-${new Date().toISOString().split('T')[0]}.${format}`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } catch (err: any) {\r\n      console.error('Failed to export audit logs:', err);\r\n    }\r\n  };\r\n\r\n  const getSeverityColor = (severity: string) => {\r\n    switch (severity) {\r\n      case 'critical':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'high':\r\n        return 'bg-orange-100 text-orange-800';\r\n      case 'medium':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'low':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'authentication':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'authorization':\r\n        return 'bg-purple-100 text-purple-800';\r\n      case 'data_access':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'data_modification':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'security':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  if (loading && logs.length === 0) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800\">Error</h3>\r\n            <div className=\"mt-2 text-sm text-red-700\">{error}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">Audit Logs</h2>\r\n          <p className=\"text-gray-600\">Monitor system activity and user actions</p>\r\n        </div>\r\n        <div className=\"flex space-x-3\">\r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500\"\r\n          >\r\n            {showFilters ? 'Hide Filters' : 'Show Filters'}\r\n          </button>\r\n          <div className=\"relative\">\r\n            <select\r\n              onChange={(e) => handleExport(e.target.value as 'csv' | 'json' | 'pdf')}\r\n              className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500\"\r\n            >\r\n              <option value=\"\">Export</option>\r\n              <option value=\"csv\">Export CSV</option>\r\n              <option value=\"json\">Export JSON</option>\r\n              <option value=\"pdf\">Export PDF</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      {stats && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"flex-shrink-0\">\r\n                <div className=\"w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center\">\r\n                  <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-gray-500\">Total Logs</p>\r\n                <p className=\"text-2xl font-semibold text-gray-900\">{stats.totalLogs.toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"flex-shrink-0\">\r\n                <div className=\"w-8 h-8 bg-red-100 rounded-md flex items-center justify-center\">\r\n                  <svg className=\"w-5 h-5 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-gray-500\">Critical</p>\r\n                <p className=\"text-2xl font-semibold text-gray-900\">{stats.logsBySeverity.critical}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"flex-shrink-0\">\r\n                <div className=\"w-8 h-8 bg-orange-100 rounded-md flex items-center justify-center\">\r\n                  <svg className=\"w-5 h-5 text-orange-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-gray-500\">High</p>\r\n                <p className=\"text-2xl font-semibold text-gray-900\">{stats.logsBySeverity.high}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"flex-shrink-0\">\r\n                <div className=\"w-8 h-8 bg-yellow-100 rounded-md flex items-center justify-center\">\r\n                  <svg className=\"w-5 h-5 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div className=\"ml-4\">\r\n                <p className=\"text-sm font-medium text-gray-500\">Medium</p>\r\n                <p className=\"text-2xl font-semibold text-gray-900\">{stats.logsBySeverity.medium}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters */}\r\n      {showFilters && (\r\n        <div className=\"bg-white rounded-lg shadow p-6\">\r\n          <h3 className=\"text-lg font-semibold mb-4\">Filters</h3>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Severity</label>\r\n              <select\r\n                value={filters.severity || ''}\r\n                onChange={(e) => handleFilterChange('severity', e.target.value || undefined)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <option value=\"\">All Severities</option>\r\n                <option value=\"low\">Low</option>\r\n                <option value=\"medium\">Medium</option>\r\n                <option value=\"high\">High</option>\r\n                <option value=\"critical\">Critical</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Category</label>\r\n              <select\r\n                value={filters.category || ''}\r\n                onChange={(e) => handleFilterChange('category', e.target.value || undefined)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <option value=\"\">All Categories</option>\r\n                <option value=\"authentication\">Authentication</option>\r\n                <option value=\"authorization\">Authorization</option>\r\n                <option value=\"data_access\">Data Access</option>\r\n                <option value=\"data_modification\">Data Modification</option>\r\n                <option value=\"system\">System</option>\r\n                <option value=\"security\">Security</option>\r\n                <option value=\"user_management\">User Management</option>\r\n                <option value=\"content_management\">Content Management</option>\r\n                <option value=\"financial\">Financial</option>\r\n                <option value=\"api_access\">API Access</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Action</label>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search actions...\"\r\n                value={filters.action || ''}\r\n                onChange={(e) => handleFilterChange('action', e.target.value || undefined)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Resource</label>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search resources...\"\r\n                value={filters.resource || ''}\r\n                onChange={(e) => handleFilterChange('resource', e.target.value || undefined)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search */}\r\n      <div className=\"bg-white rounded-lg shadow p-6\">\r\n        <div className=\"flex space-x-4\">\r\n          <div className=\"flex-1\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search audit logs...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n          <button\r\n            onClick={handleSearch}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          >\r\n            Search\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Audit Logs Table */}\r\n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full divide-y divide-gray-200\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Timestamp\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  User\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Action\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Resource\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Severity\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Category\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Status\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {logs.map((log) => (\r\n                <tr key={log._id} className=\"hover:bg-gray-50\">\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"text-sm font-medium text-gray-900\">{log.userContext.email}</div>\r\n                    <div className=\"text-sm text-gray-500\">{log.userContext.role}</div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                    {log.action}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                    {log.resource}\r\n                    {log.resourceId && (\r\n                      <span className=\"text-gray-500 ml-1\">({log.resourceId})</span>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getSeverityColor(log.severity)}`}>\r\n                      {log.severity}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getCategoryColor(log.category)}`}>\r\n                      {log.category.replace('_', ' ')}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n                      log.response.statusCode >= 200 && log.response.statusCode < 300\r\n                        ? 'bg-green-100 text-green-800'\r\n                        : 'bg-red-100 text-red-800'\r\n                    }`}>\r\n                      {log.response.statusCode}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                    <button\r\n                      onClick={() => setSelectedLog(log)}\r\n                      className=\"text-blue-600 hover:text-blue-900\"\r\n                    >\r\n                      View Details\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <button\r\n            onClick={() => handleFilterChange('page', Math.max(1, (filters.page || 1) - 1))}\r\n            disabled={(filters.page || 1) <= 1}\r\n            className=\"px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            Previous\r\n          </button>\r\n          <span className=\"text-sm text-gray-700\">\r\n            Page {filters.page || 1}\r\n          </span>\r\n          <button\r\n            onClick={() => handleFilterChange('page', (filters.page || 1) + 1)}\r\n            disabled={logs.length < (filters.limit || 50)}\r\n            className=\"px-3 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            Next\r\n          </button>\r\n        </div>\r\n        <div className=\"text-sm text-gray-700\">\r\n          Showing {logs.length} logs\r\n        </div>\r\n      </div>\r\n\r\n      {/* Log Details Modal */}\r\n      {selectedLog && (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\r\n          <div className=\"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white\">\r\n            <div className=\"mt-3\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Audit Log Details</h3>\r\n                <button\r\n                  onClick={() => setSelectedLog(null)}\r\n                  className=\"text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-900\">Basic Information</h4>\r\n                  <div className=\"mt-2 grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <span className=\"font-medium\">Action:</span> {selectedLog.action}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-medium\">Resource:</span> {selectedLog.resource}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-medium\">Severity:</span> \r\n                      <span className={`ml-1 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getSeverityColor(selectedLog.severity)}`}>\r\n                        {selectedLog.severity}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-medium\">Category:</span> \r\n                      <span className={`ml-1 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getCategoryColor(selectedLog.category)}`}>\r\n                        {selectedLog.category.replace('_', ' ')}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-medium\">Timestamp:</span> {new Date(selectedLog.timestamp).toLocaleString()}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-medium\">Status Code:</span> {selectedLog.response.statusCode}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-900\">User Context</h4>\r\n                  <div className=\"mt-2 text-sm\">\r\n                    <div><span className=\"font-medium\">Email:</span> {selectedLog.userContext.email}</div>\r\n                    <div><span className=\"font-medium\">Role:</span> {selectedLog.userContext.role}</div>\r\n                    <div><span className=\"font-medium\">Session ID:</span> {selectedLog.userContext.sessionId}</div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-900\">Request Details</h4>\r\n                  <div className=\"mt-2 text-sm\">\r\n                    <div><span className=\"font-medium\">Method:</span> {selectedLog.request.method}</div>\r\n                    <div><span className=\"font-medium\">URL:</span> {selectedLog.request.url}</div>\r\n                    <div><span className=\"font-medium\">IP:</span> {selectedLog.request.ip}</div>\r\n                    <div><span className=\"font-medium\">User Agent:</span> {selectedLog.request.userAgent}</div>\r\n                  </div>\r\n                </div>\r\n\r\n                {selectedLog.details && Object.keys(selectedLog.details).length > 0 && (\r\n                  <div>\r\n                    <h4 className=\"font-medium text-gray-900\">Details</h4>\r\n                    <div className=\"mt-2 text-sm\">\r\n                      <pre className=\"bg-gray-100 p-2 rounded text-xs overflow-auto\">\r\n                        {JSON.stringify(selectedLog.details, null, 2)}\r\n                      </pre>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {selectedLog.tags && selectedLog.tags.length > 0 && (\r\n                  <div>\r\n                    <h4 className=\"font-medium text-gray-900\">Tags</h4>\r\n                    <div className=\"mt-2 flex flex-wrap gap-1\">\r\n                      {selectedLog.tags.map((tag, index) => (\r\n                        <span key={index} className=\"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800\">\r\n                          {tag}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} ","import React from 'react';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\nimport AuditLogViewer from '@/components/audit/AuditLogViewer';\r\n\r\nexport default function AuditLogPage() {\r\n  return (\r\n    <DashboardLayout allowedRoles={['admin']}>\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        <AuditLogViewer />\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n} "],"names":["window","__NEXT_P","push","__webpack_require__","AuditLogViewer","param","organizationId","logs","setLogs","useState","stats","setStats","loading","setLoading","error","setError","selectedLog","setSelectedLog","filters","setFilters","page","limit","sortBy","sortOrder","searchTerm","setSearchTerm","showFilters","setShowFilters","useEffect","fetchAuditLogs","fetchAuditStats","response","api","get","params","data","err","message","console","handleFilterChange","key","value","prev","handleSearch","handleExport","format","post","includeDetails","includeHeaders","link","document","createElement","href","downloadUrl","download","Date","toISOString","split","concat","body","appendChild","click","removeChild","getSeverityColor","severity","getCategoryColor","category","length","jsx_runtime","jsx","div","className","jsxs","svg","viewBox","fill","path","fillRule","d","clipRule","h3","h2","p","button","onClick","select","onChange","e","target","option","stroke","strokeLinecap","strokeLinejoin","strokeWidth","totalLogs","toLocaleString","logsBySeverity","critical","high","medium","label","undefined","input","type","placeholder","action","resource","onKeyPress","table","thead","tr","th","tbody","map","td","log","timestamp","userContext","email","role","resourceId","span","replace","statusCode","_id","Math","max","disabled","h4","sessionId","request","method","url","ip","userAgent","details","Object","keys","pre","JSON","stringify","tags","tag","index","AuditLogPage","DashboardLayout","allowedRoles"],"sourceRoot":""}