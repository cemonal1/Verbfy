(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3910,576],{40578:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/talk/[reservationId]",function(){return n(6750)}])},6750:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(85893),s=n(67294),i=n(11163),c=n(9008),l=n.n(c),o=n(60576),a=n(53178);function d(){let e=(0,i.useRouter)(),{reservationId:t}=e.query,[n,c]=(0,s.useState)(null);return e.isReady&&t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:"Verbfy - Video Lesson"})}),(0,r.jsx)("div",{className:"h-screen bg-white",children:(0,r.jsx)(a.z,{children:n?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center text-red-500",children:[(0,r.jsx)("p",{className:"text-xl font-semibold",children:"Connection Error"}),(0,r.jsx)("p",{className:"mt-2",children:n.message})]})}):(0,r.jsx)(o.LiveKitRoom,{roomName:t,onError:e=>{console.error("Room error:",e),c(e)},onDisconnected:()=>{console.log("Disconnected from room")}})})})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}},60576:function(e,t,n){"use strict";n.r(t),n.d(t,{LiveKitRoom:function(){return a}});var r=n(85893),s=n(67294),i=n(60201),c=n(98019),l=n(49486),o=n(53178);n(13618);let a=e=>{let{roomName:t,onError:n,onConnected:a,onDisconnected:d}=e,{room:u,isConnecting:m,error:h,connect:x,disconnect:f}=(0,o.T)();return((0,s.useEffect)(()=>(t&&x(t).then(()=>{console.log("✅ Connected to LiveKit room:",t),null==a||a()}).catch(e=>{console.error("❌ Failed to connect to LiveKit room:",e),null==n||n(e)}),()=>{f(),null==d||d()}),[t,x,f,a,d,n]),m)?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),(0,r.jsx)("p",{className:"mt-4",children:"Connecting to room..."})]})}):h?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center text-red-500",children:[(0,r.jsxs)("p",{children:["Failed to connect: ",h.message]}),(0,r.jsx)("button",{onClick:()=>x(t),className:"mt-4 px-4 py-2 bg-primary text-white rounded hover:bg-primary-dark",children:"Try Again"})]})}):u?(0,r.jsx)("div",{className:"h-full",children:(0,r.jsxs)(i.zc,{children:[(0,r.jsx)(c.G,{tracks:(0,l.t)(),children:(0,r.jsx)(c.P,{})}),(0,r.jsx)(c.R,{}),(0,r.jsx)(i.VS,{})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("p",{children:"Room not connected"})})}},53178:function(e,t,n){"use strict";n.d(t,{T:function(){return o},z:function(){return a}});var r=n(85893),s=n(67294),i=n(95591),c=n(32798);let l=(0,s.createContext)(void 0),o=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useLiveKit must be used within a LiveKitProvider");return e},a=e=>{let{children:t}=e,[n,o]=(0,s.useState)(null),[a,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),h=(0,s.useCallback)(async e=>{try{d(!0),m(null);let{token:t,url:n}=(await c.ZP.post("/api/livekit/token/".concat(e))).data,r=new i.du({adaptiveStream:!0,dynacast:!0,stopLocalTrackOnUnpublish:!0});await r.connect(n,t),o(r)}catch(e){throw console.error("Failed to connect to LiveKit room:",e),m(e),e}finally{d(!1)}},[]),x=(0,s.useCallback)(()=>{n&&(n.disconnect(),o(null))},[n]);return(0,r.jsx)(l.Provider,{value:{room:n,isConnecting:a,error:u,connect:h,disconnect:x},children:t})}}},function(e){e.O(0,[1216,2888,179],function(){return e(e.s=40578)}),_N_E=e.O()}]);
//# sourceMappingURL=[reservationId]-0c737bcdc7e6dd90.js.map