(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3938],{30034:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cefr-tests/[testId]",function(){return s(49562)}])},49562:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var l=s(85893),n=s(67294),a=s(11163),r=s(32798),i=s(36197);let c=e=>{let{testId:t,onComplete:s}=e,c=(0,a.useRouter)(),{user:o}=(0,i.Eu)(),[d,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(0),[h,g]=(0,n.useState)(0),[p,b]=(0,n.useState)({}),[f,j]=(0,n.useState)(0),[y,N]=(0,n.useState)(!0),[v,w]=(0,n.useState)(!0),[S,_]=(0,n.useState)(!1),[T,k]=(0,n.useState)(null);(0,n.useEffect)(()=>{t&&q()},[t]),(0,n.useEffect)(()=>{if(y){if(f>0){let e=setTimeout(()=>{j(f-1)},1e3);return()=>clearTimeout(e)}0===f&&d&&E()}},[f,d,y]);let q=async()=>{try{w(!0);let e=await r.Vm.getTest(t);u(e);let s=await r.Vm.startTest(t);k(s.attemptId),N(!!s.test.timed),s.test.timed&&j(60*s.test.totalTime)}catch(e){}finally{w(!1)}},C=e=>{let t="".concat(m,"-").concat(h);b(s=>({...s,[t]:e}))},E=async()=>{if(T&&d)try{_(!0);let e=Object.entries(p).map(e=>{let[t,s]=e,[l,n]=t.split("-").map(Number);return{sectionIndex:l,questionIndex:n,studentAnswer:s,timeSpent:0}}),t=await r.Vm.submitTest(T,{answers:e,timeSpent:60*d.totalTime-f});if(s)s(t);else{try{window.sessionStorage.setItem("cefr_result_".concat(T),JSON.stringify(t))}catch(e){}c.push("/cefr-tests/results/".concat(T))}}catch(e){}finally{_(!1)}};if(v)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading test..."})]})});if(!d)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("p",{className:"text-red-600",children:"Test not found"})})});let I=d.sections[m],O=null==I?void 0:I.questions[h];return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:d.title}),(0,l.jsx)("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-2 py-1 rounded-full",children:d.cefrLevel})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["Progress: ",(()=>{if(!d)return 0;let e=d.sections.reduce((e,t)=>e+t.questions.length,0);return Object.keys(p).length/e*100})().toFixed(1),"%"]}),y&&(0,l.jsxs)("div",{className:"text-sm font-medium text-red-600",children:["⏱️ ",(e=>{let t=Math.floor(e/3600),s=Math.floor(e%3600/60),l=e%60;return t>0?"".concat(t,":").concat(s.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0")):"".concat(s,":").concat(l.toString().padStart(2,"0"))})(f)]})]})]})})}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[d.description&&(0,l.jsx)("div",{className:"bg-blue-50 border border-blue-100 text-blue-800 rounded-lg px-4 py-3 mb-6 text-sm",children:d.description}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,l.jsxs)("div",{className:"p-6 border-b",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Section ",m+1," of ",d.sections.length,": ",null==I?void 0:I.name]}),(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:["Question ",h+1," of ",null==I?void 0:I.questions.length]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(100*m/d.sections.length+100*h/(d.sections.length*(null==I?void 0:I.questions.length)),"%")}})})]}),(0,l.jsx)("div",{className:"p-6",children:O&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:O.question}),O.imageUrl&&(0,l.jsx)("img",{src:O.imageUrl,alt:"Question",className:"max-w-full h-auto rounded-lg mb-4"}),O.audioUrl&&(0,l.jsxs)("audio",{controls:!0,className:"w-full mb-4",children:[(0,l.jsx)("source",{src:O.audioUrl,type:"audio/mpeg"}),"Your browser does not support the audio element."]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:["multiple-choice"===O.type&&O.options&&(0,l.jsx)("div",{className:"space-y-3",children:O.options.map((e,t)=>(0,l.jsxs)("label",{className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"question-".concat(m,"-").concat(h),value:e,checked:p["".concat(m,"-").concat(h)]===e,onChange:e=>C(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,l.jsx)("span",{className:"ml-3 text-gray-900",children:e})]},t))}),"fill-blank"===O.type&&(0,l.jsx)("input",{type:"text",value:p["".concat(m,"-").concat(h)]||"",onChange:e=>C(e.target.value),placeholder:"Enter your answer...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),"essay"===O.type&&(0,l.jsx)("textarea",{value:p["".concat(m,"-").concat(h)]||"",onChange:e=>C(e.target.value),placeholder:"Write your answer...",rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})}),(0,l.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("button",{onClick:()=>{if(h>0)g(h-1);else if(m>0){x(m-1);let e=null==d?void 0:d.sections[m-1];g(e?e.questions.length-1:0)}},disabled:0===m&&0===h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("button",{onClick:E,disabled:S,className:"px-6 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:S?"Submitting...":"Submit Test"}),m<d.sections.length-1||h<(null==I?void 0:I.questions.length)-1?(0,l.jsx)("button",{onClick:()=>{let e=null==d?void 0:d.sections[m];e&&(h<e.questions.length-1?g(h+1):m<d.sections.length-1&&(x(m+1),g(0)))},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Next"}):null]})]})})]})]})]})};var o=s(10571);function d(){let{testId:e}=(0,a.useRouter)().query;return e&&"string"==typeof e?(0,l.jsx)(o.Z,{title:"CEFR Test",children:(0,l.jsx)(c,{testId:e,onComplete:e=>{}})}):(0,l.jsx)(o.Z,{title:"Invalid Test",children:(0,l.jsx)("div",{className:"text-center py-12",children:(0,l.jsx)("p",{className:"text-red-600 text-lg",children:"Invalid test ID"})})})}}},function(e){e.O(0,[2138,9226,9496,8484,437,5823,2244,6235,5323,747,3365,8638,9806,7093,8510,8424,8639,7855,7446,2169,8308,1408,6259,4657,8212,571,1493,2888,5514,179],function(){return e(e.s=30034)}),_N_E=e.O()}]);