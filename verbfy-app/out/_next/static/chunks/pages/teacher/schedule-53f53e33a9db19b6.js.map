{"version":3,"file":"static/chunks/pages/teacher/schedule-53f53e33a9db19b6.js","mappings":"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","sources":["webpack://_N_E/?39c2","webpack://_N_E/./pages/teacher/schedule.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/teacher/schedule\",\n      function () {\n        return require(\"private-next-pages/teacher/schedule.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/teacher/schedule\"])\n      });\n    }\n  ","import React, { useEffect, useState } from 'react';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\nimport { availabilityAPI } from '@/lib/api';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useI18n } from '@/lib/i18n';\r\n\r\nexport default function TeacherSchedulePage() {\r\n  const { user } = useAuth();\r\n  const { t } = useI18n();\r\n  const [slots, setSlots] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [date, setDate] = useState<string>('');\r\n  const [time, setTime] = useState<string>('');\r\n  const [duration, setDuration] = useState<number>(60);\r\n  const [editing, setEditing] = useState<{\r\n    id: string;\r\n    date: string;\r\n    time: string;\r\n    duration: number;\r\n  } | null>(null);\r\n\r\n  const load = async () => {\r\n    if (!user?._id) return;\r\n    try {\r\n      const res = await availabilityAPI.getAvailability(user._id);\r\n      setSlots(res.data?.data ?? res.data ?? []);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { load(); }, [user?._id]);\r\n\r\n  const addSlot = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!date || !time) return;\r\n    const start = new Date(`${date}T${time}:00`);\r\n    try {\r\n      await availabilityAPI.setAvailability({ start, duration });\r\n      setDate(''); setTime('');\r\n      await load();\r\n    } catch {}\r\n  };\r\n\r\n  const removeSlot = async (id?: string) => {\r\n    if (!id) return;\r\n    try {\r\n      await availabilityAPI.deleteAvailability(id);\r\n      setSlots(prev => prev.filter(s => (s._id || s.id) !== id));\r\n    } catch {}\r\n  };\r\n\r\n  const startToParts = (d: Date) => ({\r\n    date: d.toISOString().slice(0,10),\r\n    time: d.toTimeString().slice(0,5),\r\n  });\r\n\r\n  const startFromParts = (dateStr: string, timeStr: string) => new Date(`${dateStr}T${timeStr}:00`);\r\n\r\n  const beginEdit = (s: any) => {\r\n    const start = new Date(s.start || s.date || s);\r\n    const parts = startToParts(start);\r\n    setEditing({ id: s._id || s.id, date: parts.date, time: parts.time, duration: s.duration || 60 });\r\n  };\r\n\r\n  const saveEdit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!editing) return;\r\n    try {\r\n      await availabilityAPI.updateAvailability(editing.id, {\r\n        start: startFromParts(editing.date, editing.time),\r\n        duration: editing.duration,\r\n      });\r\n      setEditing(null);\r\n      await load();\r\n    } catch {}\r\n  };\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['teacher']} title={t('tschedule.title','My Schedule')}>\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <div className=\"lg:col-span-1 rounded-lg border p-4 bg-white\">\r\n          <div className=\"text-lg font-semibold mb-3\">{t('tschedule.add','Add available slot')}</div>\r\n          <form onSubmit={addSlot} className=\"space-y-3\">\r\n            <div>\r\n              <label className=\"block text-sm text-gray-700 mb-1\">{t('tschedule.date','Date')}</label>\r\n              <input type=\"date\" value={date} onChange={(e)=>setDate(e.target.value)} className=\"w-full border rounded-md px-3 py-2\" required />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm text-gray-700 mb-1\">{t('tschedule.time','Time')}</label>\r\n              <input type=\"time\" value={time} onChange={(e)=>setTime(e.target.value)} className=\"w-full border rounded-md px-3 py-2\" required />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm text-gray-700 mb-1\">{t('tschedule.duration','Duration (min)')}</label>\r\n              <input type=\"number\" min={15} step={15} value={duration} onChange={(e)=>setDuration(parseInt(e.target.value||'60'))} className=\"w-full border rounded-md px-3 py-2\" />\r\n            </div>\r\n            <button type=\"submit\" className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\">{t('tschedule.addBtn','Add Slot')}</button>\r\n          </form>\r\n        </div>\r\n        <div className=\"lg:col-span-2 rounded-lg border p-4 bg-white\">\r\n          <div className=\"text-lg font-semibold mb-3\">{t('tschedule.list','Upcoming availability')}</div>\r\n          {loading ? (\r\n            <div className=\"p-6 text-center text-gray-500\">{t('common.loading','Loading...')}</div>\r\n          ) : slots.length === 0 ? (\r\n            <div className=\"p-6 text-center text-gray-500\">{t('tschedule.empty','No availability yet')}</div>\r\n          ) : (\r\n            <ul className=\"divide-y divide-gray-200\">\r\n              {slots.map((s: any, idx: number) => {\r\n                const start = new Date(s.start || s.date || s);\r\n                const label = `${start.toLocaleDateString()} ${start.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}`;\r\n                const isEditing = !!editing && editing.id === (s._id || s.id);\r\n                return (\r\n                  <li key={s._id || idx} className=\"py-3 flex items-center justify-between\">\r\n                    <div className=\"text-gray-800\">\r\n                      {isEditing ? (\r\n                        <form onSubmit={saveEdit} className=\"flex items-center gap-2\">\r\n                          <input\r\n                            type=\"date\"\r\n                            value={editing?.date ?? ''}\r\n                            onChange={(e)=>setEditing(prev => prev ? { ...prev, date: e.target.value } : prev)}\r\n                            className=\"border rounded px-2 py-1 text-sm\"\r\n                            required\r\n                          />\r\n                          <input\r\n                            type=\"time\"\r\n                            value={editing?.time ?? ''}\r\n                            onChange={(e)=>setEditing(prev => prev ? { ...prev, time: e.target.value } : prev)}\r\n                            className=\"border rounded px-2 py-1 text-sm\"\r\n                            required\r\n                          />\r\n                          <input\r\n                            type=\"number\"\r\n                            min={15}\r\n                            step={15}\r\n                            value={editing?.duration ?? 60}\r\n                            onChange={(e)=>setEditing(prev => prev ? { ...prev, duration: parseInt(e.target.value || '60') } : prev)}\r\n                            className=\"w-24 border rounded px-2 py-1 text-sm\"\r\n                          />\r\n                          <button type=\"submit\" className=\"px-3 py-1 rounded-md text-xs bg-blue-600 text-white hover:bg-blue-700\">{t('common.save','Save')}</button>\r\n                          <button type=\"button\" onClick={()=>setEditing(null)} className=\"px-3 py-1 rounded-md text-xs bg-gray-200 text-gray-800 hover:bg-gray-300\">{t('common.cancel','Cancel')}</button>\r\n                        </form>\r\n                      ) : (\r\n                        label\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <button onClick={() => beginEdit(s)} className=\"px-3 py-1 rounded-md text-xs bg-gray-100 text-gray-800 hover:bg-gray-200\">\r\n                        {t('common.edit','Edit')}\r\n                      </button>\r\n                      <button onClick={() => removeSlot(s._id || s.id)} className=\"px-3 py-1 rounded-md text-xs bg-red-600 text-white hover:bg-red-700\">\r\n                        {t('common.delete','Delete')}\r\n                      </button>\r\n                    </div>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n}\r\n\r\n\r\n"],"names":["window","__NEXT_P","push","__webpack_require__","TeacherSchedulePage","user","useAuth","t","useI18n","slots","setSlots","useState","loading","setLoading","date","setDate","time","setTime","duration","setDuration","editing","setEditing","load","_id","res","availabilityAPI","getAvailability","data","useEffect","addSlot","e","preventDefault","start","Date","concat","setAvailability","removeSlot","id","deleteAvailability","prev","filter","s","startToParts","d","toISOString","slice","toTimeString","startFromParts","dateStr","timeStr","beginEdit","parts","saveEdit","updateAvailability","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","DashboardLayout","allowedRoles","title","jsxs","div","className","form","onSubmit","label","input","type","value","onChange","target","required","min","step","parseInt","button","length","ul","map","idx","toLocaleDateString","toLocaleTimeString","hour","minute","isEditing","li","onClick"],"sourceRoot":""}