{"version":3,"file":"static/chunks/pages/verbfy-talk/[roomId]-76279c0a858bb848.js","mappings":"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","sources":["webpack://_N_E/?9c3e","webpack://_N_E/./src/hooks/useVoiceChat.ts","webpack://_N_E/./src/components/voiceChat/VoiceChatRoom.tsx","webpack://_N_E/./pages/verbfy-talk/[roomId].tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/verbfy-talk/[roomId]\",\n      function () {\n        return require(\"private-next-pages/verbfy-talk/[roomId].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/verbfy-talk/[roomId]\"])\n      });\n    }\n  ","import { useState, useEffect, useRef, useCallback } from 'react';\nimport io, { Socket } from 'socket.io-client';\n\ninterface User {\n  id: string;\n  name: string;\n  socketId: string;\n}\n\ninterface VoiceChatState {\n  isConnected: boolean;\n  isConnecting: boolean;\n  currentRoom: string | null;\n  users: User[];\n  localStream: MediaStream | null;\n  isMicOn: boolean;\n  error: string | null;\n  connectionStatus: 'disconnected' | 'connecting' | 'connected' | 'error';\n}\n\ninterface VoiceChatActions {\n  connect: (token: string) => Promise<void>;\n  disconnect: () => void;\n  joinRoom: (roomId: string) => Promise<void>;\n  leaveRoom: () => void;\n  toggleMic: () => void;\n  requestMicrophone: () => Promise<boolean>;\n  clearError: () => void;\n}\n\nexport function useVoiceChat(): VoiceChatState & VoiceChatActions {\n  const [state, setState] = useState<VoiceChatState>({\n    isConnected: false,\n    isConnecting: false,\n    currentRoom: null,\n    users: [],\n    localStream: null,\n    isMicOn: true,\n    error: null,\n    connectionStatus: 'disconnected'\n  });\n\n  const socketRef = useRef<Socket | null>(null);\n  const peerConnectionsRef = useRef<Map<string, RTCPeerConnection>>(new Map());\n  const audioRefsRef = useRef<Map<string, HTMLAudioElement>>(new Map());\n  const localStreamRef = useRef<MediaStream | null>(null);\n  const reconnectAttemptsRef = useRef(0);\n  const maxReconnectAttempts = 3;\n\n  // WebRTC configuration\n  const webrtcConfig = {\n    iceServers: [\n      { urls: 'stun:stun.l.google.com:19302' },\n      { urls: 'stun:stun1.l.google.com:19302' },\n      { urls: 'stun:stun2.l.google.com:19302' },\n      { urls: 'stun:stun3.l.google.com:19302' }\n    ]\n  };\n\n  // Initialize audio context for Safari\n  const initAudioContext = useCallback(() => {\n    if (typeof window !== 'undefined' && window.AudioContext) {\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      \n      // Resume audio context on user interaction\n      const resumeAudio = () => {\n        if (audioContext.state === 'suspended') {\n          audioContext.resume();\n        }\n      };\n      \n      document.addEventListener('click', resumeAudio, { once: true });\n      document.addEventListener('touchstart', resumeAudio, { once: true });\n    }\n  }, []);\n\n  // Request microphone access\n  const requestMicrophone = useCallback(async (): Promise<boolean> => {\n    try {\n      console.log('üé§ Requesting microphone access...');\n      \n      // Check if we're in a secure context\n      if (!window.isSecureContext) {\n        throw new Error('Microphone access requires HTTPS');\n      }\n\n      // Check permissions policy\n      if (navigator.permissions) {\n        try {\n          const permission = await navigator.permissions.query({ name: 'microphone' as PermissionName });\n          console.log('üîç Microphone permission status:', permission.state);\n          \n          if (permission.state === 'denied') {\n            throw new Error('Microphone permission permanently denied');\n          }\n        } catch (permError) {\n          console.log('‚ö†Ô∏è Could not check permission status, proceeding with getUserMedia');\n        }\n      }\n\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 44100,\n          channelCount: 1\n        }\n      });\n\n      console.log('‚úÖ Microphone access granted');\n      localStreamRef.current = stream;\n      \n      setState(prev => ({\n        ...prev,\n        localStream: stream,\n        isMicOn: true,\n        error: null\n      }));\n\n      return true;\n    } catch (err: any) {\n      console.error(\"‚ùå Microphone error:\", err);\n      \n      let errorMessage = 'Microphone access denied';\n      if (err.name === 'NotAllowedError') {\n        errorMessage = 'Microphone permission denied. Please allow microphone access and try again.';\n      } else if (err.name === 'NotFoundError') {\n        errorMessage = 'No microphone found. Please connect a microphone and try again.';\n      } else if (err.name === 'NotSupportedError') {\n        errorMessage = 'Microphone access not supported in this browser.';\n      } else if (err.name === 'NotReadableError') {\n        errorMessage = 'Microphone is already in use by another application.';\n      } else if (err.message.includes('secure context')) {\n        errorMessage = 'Microphone access requires HTTPS. Please use https://verbfy.com instead of http.';\n      } else if (err.message.includes('permanently denied')) {\n        errorMessage = 'Microphone access permanently blocked. Please enable it in browser settings.';\n      } else if (err.message.includes('permissions policy')) {\n        errorMessage = 'Permissions policy violation. Please try refreshing the page or check browser settings.';\n      }\n      \n      setState(prev => ({\n        ...prev,\n        error: errorMessage,\n        localStream: null,\n        isMicOn: false\n      }));\n\n      return false;\n    }\n  }, []);\n\n  // Create peer connection\n  const createPeerConnection = useCallback((socketId: string, isInitiator: boolean): RTCPeerConnection => {\n    const peer = new RTCPeerConnection(webrtcConfig);\n    \n    // Add local stream if available\n    if (localStreamRef.current) {\n      localStreamRef.current.getTracks().forEach(track => {\n        peer.addTrack(track, localStreamRef.current!);\n      });\n    }\n\n    // Handle remote stream\n    peer.ontrack = (event) => {\n      console.log(`üéµ Received audio stream from ${socketId}`);\n      \n      const remoteStream = event.streams[0];\n      \n      // Create audio element for remote peer\n      const audio = document.createElement('audio');\n      audio.srcObject = remoteStream;\n      audio.autoplay = true;\n      audio.volume = 0.8;\n      audio.muted = false;\n      \n      // Cross-platform audio attributes\n      audio.setAttribute('playsinline', 'true');\n      audio.setAttribute('webkit-playsinline', 'true');\n      audio.setAttribute('controls', 'false');\n      audio.setAttribute('preload', 'none');\n      \n      // Store reference\n      audioRefsRef.current.set(socketId, audio);\n      \n      // Add to DOM\n      document.body.appendChild(audio);\n    };\n\n    // Handle ICE candidates\n    peer.onicecandidate = (event) => {\n      if (event.candidate && socketRef.current) {\n        socketRef.current.emit('signal', {\n          to: socketId,\n          data: {\n            type: 'ice-candidate',\n            candidate: event.candidate\n          }\n        });\n      }\n    };\n\n    // Handle connection state changes\n    peer.onconnectionstatechange = () => {\n      console.log(`üîó Peer connection state with ${socketId}:`, peer.connectionState);\n    };\n\n    peerConnectionsRef.current.set(socketId, peer);\n    return peer;\n  }, []);\n\n  // Handle signaling data\n  const handleSignal = useCallback(async (data: any) => {\n    const { from, signal, userName } = data;\n    \n    if (!localStreamRef.current) return;\n\n    let peer = peerConnectionsRef.current.get(from);\n    \n    if (!peer) {\n      peer = createPeerConnection(from, false);\n    }\n\n    try {\n      if (signal.type === 'offer') {\n        await peer.setRemoteDescription(new RTCSessionDescription(signal));\n        const answer = await peer.createAnswer();\n        await peer.setLocalDescription(answer);\n        \n        socketRef.current?.emit('signal', {\n          to: from,\n          signal: answer,\n          userName: 'User'\n        });\n      } else if (signal.type === 'answer') {\n        await peer.setRemoteDescription(new RTCSessionDescription(signal));\n      } else if (signal.type === 'ice-candidate') {\n        await peer.addIceCandidate(new RTCIceCandidate(signal.candidate));\n      }\n    } catch (error) {\n      console.error('‚ùå Error handling signal:', error);\n    }\n  }, [createPeerConnection]);\n\n  // Connect to server\n  const connect = useCallback(async (token: string): Promise<void> => {\n    if (socketRef.current?.connected) {\n      console.log('üîå Already connected');\n      return;\n    }\n\n    setState(prev => ({ ...prev, isConnecting: true, connectionStatus: 'connecting' }));\n\n    try {\n      const socket = io(process.env.NEXT_PUBLIC_BACKEND_URL || 'https://api.verbfy.com', {\n        path: '/socket.io',\n        transports: ['websocket', 'polling'],\n        forceNew: true,\n        withCredentials: true,\n        auth: {\n          token\n        }\n      });\n\n      socket.on('connect', () => {\n        console.log('‚úÖ Socket connected successfully');\n        setState(prev => ({\n          ...prev,\n          isConnected: true,\n          isConnecting: false,\n          connectionStatus: 'connected',\n          error: null\n        }));\n        reconnectAttemptsRef.current = 0;\n      });\n\n      socket.on('connect_error', (err) => {\n        console.error('‚ùå Socket connection error:', err);\n        setState(prev => ({\n          ...prev,\n          isConnecting: false,\n          connectionStatus: 'error',\n          error: 'Failed to connect to server. Please try again.'\n        }));\n      });\n\n      socket.on('disconnect', (reason) => {\n        console.log('üîå Socket disconnected:', reason);\n        setState(prev => ({\n          ...prev,\n          isConnected: false,\n          connectionStatus: 'disconnected'\n        }));\n\n        // Attempt reconnection\n        if (reconnectAttemptsRef.current < maxReconnectAttempts) {\n          reconnectAttemptsRef.current++;\n          console.log(`üîÑ Attempting reconnection ${reconnectAttemptsRef.current}/${maxReconnectAttempts}`);\n          setTimeout(() => {\n            socket.connect();\n          }, 2000 * reconnectAttemptsRef.current);\n        }\n      });\n\n      socket.on('roomJoined', (data) => {\n        console.log('üè† Joined room:', data);\n        setState(prev => ({\n          ...prev,\n          currentRoom: data.roomId,\n          users: data.users.map((u: any) => ({\n            id: u.userId,\n            name: u.userName,\n            socketId: u.userId\n          }))\n        }));\n      });\n\n      socket.on('userJoined', (data) => {\n        console.log('üë§ User joined:', data);\n        setState(prev => ({\n          ...prev,\n          users: [...prev.users, { id: data.userId, name: data.userName, socketId: data.userId }]\n        }));\n\n        // Create peer connection for new user\n        if (localStreamRef.current) {\n          const peer = createPeerConnection(data.userId, true);\n          \n          // Create offer\n          peer.createOffer().then(offer => {\n            peer.setLocalDescription(offer);\n            socket.emit('signal', {\n              to: data.userId,\n              signal: offer,\n              userName: 'User'\n            });\n          }).catch(error => {\n            console.error('‚ùå Error creating offer:', error);\n          });\n        }\n      });\n\n      socket.on('userLeft', (socketId) => {\n        console.log('üëã User left:', socketId);\n        setState(prev => ({\n          ...prev,\n          users: prev.users.filter(user => user.socketId !== socketId)\n        }));\n\n        // Close peer connection\n        const peer = peerConnectionsRef.current.get(socketId);\n        if (peer) {\n          peer.close();\n          peerConnectionsRef.current.delete(socketId);\n        }\n\n        // Remove audio element\n        const audio = audioRefsRef.current.get(socketId);\n        if (audio && audio.parentNode) {\n          audio.parentNode.removeChild(audio);\n          audioRefsRef.current.delete(socketId);\n        }\n      });\n\n      socket.on('signal', handleSignal);\n\n      socket.on('roomFull', (data) => {\n        console.log('‚ùå Room is full:', data);\n        setState(prev => ({\n          ...prev,\n          error: data.message\n        }));\n      });\n\n      socket.on('error', (data) => {\n        console.error('‚ùå Server error:', data);\n        setState(prev => ({\n          ...prev,\n          error: data.message\n        }));\n      });\n\n      socketRef.current = socket;\n\n    } catch (error) {\n      console.error('‚ùå Connection failed:', error);\n      setState(prev => ({\n        ...prev,\n        isConnecting: false,\n        connectionStatus: 'error',\n        error: 'Failed to connect to server'\n      }));\n    }\n  }, [handleSignal, createPeerConnection]);\n\n  // Disconnect from server\n  const disconnect = useCallback(() => {\n    if (socketRef.current) {\n      socketRef.current.disconnect();\n      socketRef.current = null;\n    }\n\n    // Cleanup peer connections\n    peerConnectionsRef.current.forEach(peer => peer.close());\n    peerConnectionsRef.current.clear();\n\n    // Cleanup audio elements\n    audioRefsRef.current.forEach(audio => {\n      if (audio.parentNode) {\n        audio.parentNode.removeChild(audio);\n      }\n    });\n    audioRefsRef.current.clear();\n\n    // Cleanup local stream\n    if (localStreamRef.current) {\n      localStreamRef.current.getTracks().forEach(track => track.stop());\n      localStreamRef.current = null;\n    }\n\n    setState(prev => ({\n      ...prev,\n      isConnected: false,\n      isConnecting: false,\n      currentRoom: null,\n      users: [],\n      localStream: null,\n      isMicOn: false,\n      connectionStatus: 'disconnected'\n    }));\n  }, []);\n\n  // Join room\n  const joinRoom = useCallback(async (roomId: string): Promise<void> => {\n    if (!socketRef.current?.connected) {\n      setState(prev => ({ ...prev, error: 'Not connected to server' }));\n      return;\n    }\n\n    try {\n      // Request microphone access first\n      const micGranted = await requestMicrophone();\n      if (!micGranted) {\n        setState(prev => ({ ...prev, error: 'Microphone access required to join room' }));\n        return;\n      }\n\n      socketRef.current.emit('joinVerbfyTalkRoom', { roomId });\n    } catch (error) {\n      console.error('‚ùå Failed to join room:', error);\n      setState(prev => ({ ...prev, error: 'Failed to join room' }));\n    }\n  }, [requestMicrophone]);\n\n  // Leave room\n  const leaveRoom = useCallback(() => {\n    if (socketRef.current && state.currentRoom) {\n      socketRef.current.emit('leaveVerbfyTalkRoom', { roomId: state.currentRoom });\n    }\n\n    // Cleanup peer connections\n    peerConnectionsRef.current.forEach(peer => peer.close());\n    peerConnectionsRef.current.clear();\n\n    // Cleanup audio elements\n    audioRefsRef.current.forEach(audio => {\n      if (audio.parentNode) {\n        audio.parentNode.removeChild(audio);\n      }\n    });\n    audioRefsRef.current.clear();\n\n    setState(prev => ({\n      ...prev,\n      currentRoom: null,\n      users: []\n    }));\n  }, [state.currentRoom]);\n\n  // Toggle microphone\n  const toggleMic = useCallback(() => {\n    if (localStreamRef.current) {\n      const audioTrack = localStreamRef.current.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setState(prev => ({\n          ...prev,\n          isMicOn: audioTrack.enabled\n        }));\n      }\n    }\n  }, []);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setState(prev => ({ ...prev, error: null }));\n  }, []);\n\n  // Initialize audio context on mount\n  useEffect(() => {\n    initAudioContext();\n  }, [initAudioContext]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      disconnect();\n    };\n  }, [disconnect]);\n\n  return {\n    ...state,\n    connect,\n    disconnect,\n    joinRoom,\n    leaveRoom,\n    toggleMic,\n    requestMicrophone,\n    clearError\n  };\n}\n","import React, { useState, useEffect } from 'react';\r\nimport { useAuthContext } from '@/context/AuthContext';\r\nimport { useVoiceChat } from '@/hooks/useVoiceChat';\r\nimport { tokenStorage } from '@/utils/secureStorage';\r\n\r\ninterface VoiceChatRoomProps {\r\n  roomId: string;\r\n  onLeave?: () => void;\r\n}\r\n\r\nexport default function VoiceChatRoom({ roomId, onLeave }: VoiceChatRoomProps) {\r\n  const { user } = useAuthContext();\r\n  const [isJoining, setIsJoining] = useState(false);\r\n  \r\n  const {\r\n    isConnected,\r\n    isConnecting,\r\n    currentRoom,\r\n    users,\r\n    localStream,\r\n    isMicOn,\r\n    error,\r\n    connectionStatus,\r\n    connect,\r\n    disconnect,\r\n    joinRoom,\r\n    leaveRoom,\r\n    toggleMic,\r\n    requestMicrophone,\r\n    clearError\r\n  } = useVoiceChat();\r\n\r\n  // Connect to server when component mounts\r\n  useEffect(() => {\r\n    const connectToServer = async () => {\r\n      const token = tokenStorage.getToken();\r\n      if (token && user && !isConnected && !isConnecting) {\r\n        try {\r\n          await connect(token);\r\n        } catch (error) {\r\n          console.error('‚ùå Failed to connect to server:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    connectToServer();\r\n  }, [user, isConnected, isConnecting, connect]);\r\n\r\n  // Join room when connected\r\n  useEffect(() => {\r\n    const joinRoomWhenReady = async () => {\r\n      if (isConnected && !currentRoom && !isJoining) {\r\n        setIsJoining(true);\r\n        try {\r\n          await joinRoom(roomId);\r\n        } catch (error) {\r\n          console.error('‚ùå Failed to join room:', error);\r\n        } finally {\r\n          setIsJoining(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    joinRoomWhenReady();\r\n  }, [isConnected, currentRoom, roomId, isJoining, joinRoom]);\r\n\r\n  const handleLeaveRoom = () => {\r\n    leaveRoom();\r\n    disconnect();\r\n    onLeave?.();\r\n  };\r\n\r\n  const handleRequestMicrophone = async () => {\r\n    const granted = await requestMicrophone();\r\n    if (granted && isConnected) {\r\n      await joinRoom(roomId);\r\n    }\r\n  };\r\n\r\n  const getConnectionStatusColor = () => {\r\n    switch (connectionStatus) {\r\n      case 'connected': return 'text-green-600';\r\n      case 'connecting': return 'text-yellow-600';\r\n      case 'error': return 'text-red-600';\r\n      default: return 'text-gray-600';\r\n    }\r\n  };\r\n\r\n  const getConnectionStatusIcon = () => {\r\n    switch (connectionStatus) {\r\n      case 'connected': return 'üü¢';\r\n      case 'connecting': return 'üü°';\r\n      case 'error': return 'üî¥';\r\n      default: return '‚ö™';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-6\">\r\n      {/* Header */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border p-6 mb-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900 flex items-center gap-3\">\r\n              üé§ Voice Chat Room\r\n            </h1>\r\n            <p className=\"text-gray-600 mt-1\">Room ID: {roomId}</p>\r\n            <p className=\"text-sm text-gray-500 mt-2\">\r\n              Maximum 5 participants ‚Ä¢ Audio only ‚Ä¢ P2P connection\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-3\">\r\n            <button\r\n              onClick={handleLeaveRoom}\r\n              className=\"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors\"\r\n            >\r\n              Leave Room\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Error Display */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-red-600\">‚ùå</span>\r\n            <p className=\"text-red-800\">{error}</p>\r\n          </div>\r\n          <button\r\n            onClick={clearError}\r\n            className=\"mt-2 text-sm text-red-600 hover:text-red-800 underline\"\r\n          >\r\n            Dismiss\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Connection Status */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border p-6 mb-6\">\r\n        <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">Connection Status</h2>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-lg\">{getConnectionStatusIcon()}</span>\r\n            <span className={`text-sm font-medium ${getConnectionStatusColor()}`}>\r\n              Server: {connectionStatus.charAt(0).toUpperCase() + connectionStatus.slice(1)}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className={`w-3 h-3 rounded-full ${localStream ? 'bg-green-500' : 'bg-gray-400'}`}></div>\r\n            <span className=\"text-sm text-gray-700\">\r\n              Microphone: {localStream ? 'Active' : 'Inactive'}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className={`w-3 h-3 rounded-full ${currentRoom ? 'bg-green-500' : 'bg-gray-400'}`}></div>\r\n            <span className=\"text-sm text-gray-700\">\r\n              Room: {currentRoom ? 'Joined' : 'Not Joined'}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 flex flex-col items-center justify-center p-8\">\r\n        {/* Loading State */}\r\n        {(isConnecting || isJoining) && (\r\n          <div className=\"text-center mb-8\">\r\n            <div className=\"bg-white rounded-lg shadow-md p-8 max-w-md mx-auto\">\r\n              <div className=\"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600\"></div>\r\n              </div>\r\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-4\">\r\n                {isConnecting ? 'Connecting to Server...' : 'Joining Room...'}\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {isConnecting ? 'Establishing connection...' : 'Requesting microphone access...'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Microphone Permission Required */}\r\n        {isConnected && !localStream && !isJoining && (\r\n          <div className=\"text-center mb-8\">\r\n            <div className=\"bg-white rounded-lg shadow-md p-8 max-w-md mx-auto\">\r\n              <div className=\"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                <span className=\"text-3xl\">üé§</span>\r\n              </div>\r\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-4\">\r\n                Microphone Access Required\r\n              </h3>\r\n              <p className=\"text-gray-600 mb-6\">\r\n                To join the voice chat, you need to allow microphone access. Click the button below to request permission.\r\n              </p>\r\n              <button\r\n                onClick={handleRequestMicrophone}\r\n                className=\"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-colors\"\r\n              >\r\n                üéß Allow Microphone\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Participants Grid */}\r\n        {localStream && currentRoom && (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl w-full\">\r\n            {/* Local User */}\r\n            <div className=\"bg-white rounded-lg shadow-md p-6 text-center\">\r\n              <div className=\"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                <svg className=\"w-10 h-10 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"font-semibold text-gray-900 mb-2\">\r\n                {user?.name || 'You'} {isMicOn ? 'üé§' : 'üîá'}\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">Local</p>\r\n              {!isMicOn && (\r\n                <div className=\"mt-2 text-xs text-red-500 bg-red-50 px-2 py-1 rounded\">\r\n                  Microphone Off\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Remote Users */}\r\n            {users.map((user) => (\r\n              <div key={user.socketId} className=\"bg-white rounded-lg shadow-md p-6 text-center\">\r\n                <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                  <svg className=\"w-10 h-10 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                  </svg>\r\n                </div>\r\n                <h3 className=\"font-semibold text-gray-900 mb-2\">\r\n                  {user.name} üé§\r\n                </h3>\r\n                <p className=\"text-sm text-gray-600\">Remote</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Room Info */}\r\n        <div className=\"mt-8 text-center\">\r\n          <div className=\"bg-white rounded-lg shadow-sm border p-6 max-w-2xl mx-auto\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Room Information</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600\">\r\n              <div>\r\n                <span className=\"font-medium\">Room ID:</span> {roomId}\r\n              </div>\r\n              <div>\r\n                <span className=\"font-medium\">Participants:</span> {users.length + (localStream ? 1 : 0)}/5\r\n              </div>\r\n              <div>\r\n                <span className=\"font-medium\">Connection:</span> P2P WebRTC\r\n              </div>\r\n              <div>\r\n                <span className=\"font-medium\">Audio Quality:</span> High\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Audio Controls */}\r\n      {localStream && currentRoom && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6 mt-6\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Audio Controls</h3>\r\n          <div className=\"flex items-center justify-center gap-4\">\r\n            <button\r\n              onClick={toggleMic}\r\n              className={`flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-colors ${\r\n                isMicOn \r\n                  ? 'bg-green-100 text-green-700 hover:bg-green-200' \r\n                  : 'bg-red-100 text-red-700 hover:bg-red-200'\r\n              }`}\r\n            >\r\n              {isMicOn ? 'üé§ Mute' : 'üîá Unmute'}\r\n            </button>\r\n            \r\n            <button\r\n              onClick={handleLeaveRoom}\r\n              className=\"flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-colors bg-red-100 text-red-700 hover:bg-red-200\"\r\n            >\r\n              üö™ Leave Room\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\nimport VoiceChatRoom from '@/components/voiceChat/VoiceChatRoom';\r\n\r\nexport default function VerbfyTalkRoom() {\r\n  const router = useRouter();\r\n  const { roomId } = router.query as { roomId?: string };\r\n\r\n  const handleLeaveRoom = () => {\r\n    router.push('/verbfy-talk');\r\n  };\r\n\r\n  if (!roomId) {\r\n    return (\r\n      <DashboardLayout title=\"VerbfyTalk\">\r\n        <div className=\"flex items-center justify-center min-h-screen\">\r\n          <div className=\"text-center\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Room Not Found</h1>\r\n            <p className=\"text-gray-600 mb-6\">The room you're looking for doesn't exist.</p>\r\n            <button\r\n              onClick={() => router.push('/verbfy-talk')}\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors\"\r\n            >\r\n              Back to Rooms\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DashboardLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>VerbfyTalk Room - {roomId}</title>\r\n        <meta name=\"description\" content=\"Join the conversation in VerbfyTalk\" />\r\n      </Head>\r\n      \r\n      <DashboardLayout title={`VerbfyTalk Room: ${roomId}`}>\r\n        <VoiceChatRoom roomId={roomId} onLeave={handleLeaveRoom} />\r\n      </DashboardLayout>\r\n    </>\r\n  );\r\n}"],"names":["window","__NEXT_P","push","__webpack_require__","VoiceChatRoom","param","roomId","onLeave","user","useAuthContext","isJoining","setIsJoining","useState","isConnected","isConnecting","currentRoom","users","localStream","isMicOn","error","connectionStatus","connect","disconnect","joinRoom","leaveRoom","toggleMic","requestMicrophone","clearError","useVoiceChat","state","setState","socketRef","useRef","peerConnectionsRef","Map","audioRefsRef","localStreamRef","reconnectAttemptsRef","webrtcConfig","iceServers","urls","initAudioContext","useCallback","AudioContext","audioContext","webkitAudioContext","resumeAudio","resume","document","addEventListener","once","console","log","isSecureContext","navigator","permissions","permission","query","name","permError","stream","mediaDevices","getUserMedia","audio","echoCancellation","noiseSuppression","autoGainControl","sampleRate","channelCount","current","prev","err","errorMessage","message","includes","createPeerConnection","socketId","isInitiator","peer","RTCPeerConnection","getTracks","forEach","track","addTrack","ontrack","concat","remoteStream","event","streams","createElement","srcObject","autoplay","volume","muted","setAttribute","set","body","appendChild","onicecandidate","candidate","emit","to","data","type","onconnectionstatechange","connectionState","handleSignal","from","signal","userName","get","setRemoteDescription","RTCSessionDescription","answer","createAnswer","setLocalDescription","addIceCandidate","RTCIceCandidate","token","connected","socket","io","process","env","NEXT_PUBLIC_BACKEND_URL","path","transports","forceNew","withCredentials","auth","on","reason","maxReconnectAttempts","setTimeout","map","id","u","userId","createOffer","then","offer","catch","filter","close","delete","parentNode","removeChild","clear","stop","audioTrack","getAudioTracks","enabled","useEffect","connectToServer","tokenStorage","getToken","joinRoomWhenReady","handleLeaveRoom","handleRequestMicrophone","jsx_runtime","jsxs","div","className","jsx","h1","p","button","onClick","span","h2","getConnectionStatusIcon","getConnectionStatusColor","charAt","toUpperCase","slice","h3","svg","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","length","VerbfyTalkRoom","router","useRouter","Fragment","Head","title","meta","content","DashboardLayout"],"sourceRoot":""}