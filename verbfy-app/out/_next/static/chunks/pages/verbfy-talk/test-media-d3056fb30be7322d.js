(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6331],{22282:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verbfy-talk/test-media",function(){return t(94063)}])},94063:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var r=t(85893),a=t(67294),n=t(11163),i=t(11088),c=t(82861),l=t(11429),o=t(61937),d=t(22877),m=t(29711),u=function(){let e=(0,n.useRouter)(),s=(0,a.useRef)(null),[t,u]=(0,a.useState)(null),[h,x]=(0,a.useState)(0),[g,b]=(0,a.useState)({camera:"unknown",microphone:"unknown"}),[p,f]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),w=(0,a.useRef)(null),y=(0,a.useRef)(null),v=(0,a.useRef)();(0,a.useEffect)(()=>()=>{t&&t.getTracks().forEach(e=>e.stop()),w.current&&w.current.close(),v.current&&cancelAnimationFrame(v.current)},[t]);let k=async()=>{try{f(null),b({camera:"testing",microphone:"testing"});let e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});u(e),s.current&&(s.current.srcObject=e),T(e);let t=e.getVideoTracks().length>0,r=e.getAudioTracks().length>0;b({camera:t?"granted":"denied",microphone:r?"granted":"denied"})}catch(s){let e="Failed to access media devices";s instanceof Error&&("NotAllowedError"===s.name?e="Camera and microphone access denied. Please allow access and try again.":"NotFoundError"===s.name?e="No camera or microphone found. Please check your devices.":"NotReadableError"===s.name&&(e="Camera or microphone is already in use by another application.")),f(e),b({camera:"denied",microphone:"denied"})}},T=e=>{if(e.getAudioTracks()[0])try{let s=new(window.AudioContext||window.webkitAudioContext),t=s.createAnalyser(),r=s.createMediaStreamSource(e);t.fftSize=256,r.connect(t),w.current=s,y.current=t,C()}catch(e){}},C=()=>{if(!y.current)return;let e=new Uint8Array(y.current.frequencyBinCount),s=()=>{y.current&&(y.current.getByteFrequencyData(e),x(Math.min(100,e.reduce((e,s)=>e+s,0)/e.length/128*100)),v.current=requestAnimationFrame(s))};s()},A=e=>{switch(e){case"granted":return(0,r.jsx)(l.Z,{className:"w-6 h-6 text-green-500"});case"denied":return(0,r.jsx)(m.Z,{className:"w-6 h-6 text-red-500"});case"testing":return(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"});default:return(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"})}};return(0,r.jsx)(i.Z,{allowedRoles:["student","teacher"],children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,r.jsx)("button",{onClick:()=>e.push("/verbfy-talk"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,r.jsx)(c.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Media Test"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Test your camera and microphone before joining a room"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,r.jsx)(d.Z,{className:"w-6 h-6"}),"Camera Test"]}),(0,r.jsx)("div",{className:"aspect-video bg-gray-900 rounded-lg overflow-hidden mb-4",children:(0,r.jsx)("video",{ref:s,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"})}),(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[A(g.camera),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Camera: ","granted"===g.camera?"Working":"denied"===g.camera?"Access Denied":"testing"===g.camera?"Testing...":"Not Tested"]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"w-6 h-6"}),"Microphone Test"]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Speak to test your microphone:"})}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4",children:(0,r.jsx)("div",{className:"bg-green-500 h-4 rounded-full transition-all duration-100",style:{width:"".concat(h,"%")}})}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Audio Level: ",Math.round(h),"%"]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("button",{onClick:()=>{N(!0);let e=new(window.AudioContext||window.webkitAudioContext),s=e.createOscillator(),t=e.createGain();s.connect(t),t.connect(e.destination),s.frequency.setValueAtTime(440,e.currentTime),t.gain.setValueAtTime(.1,e.currentTime),s.start(),s.stop(e.currentTime+.5),setTimeout(()=>{N(!1),e.close()},600)},disabled:j,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded transition-colors",children:j?"Playing Test Sound...":"Test Speakers"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Click to play a test sound through your speakers"})]}),(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[A(g.microphone),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Microphone: ","granted"===g.microphone?"Working":"denied"===g.microphone?"Access Denied":"testing"===g.microphone?"Testing...":"Not Tested"]})]})})]})]}),p&&(0,r.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-red-800",children:"Media Access Error"}),(0,r.jsx)("p",{className:"text-red-700 mt-1",children:p}),(0,r.jsxs)("div",{className:"mt-3 text-sm text-red-600",children:[(0,r.jsx)("p",{className:"font-medium",children:"To fix this:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Click the camera/microphone icon in your browser's address bar"}),(0,r.jsx)("li",{children:'Select "Allow" for both camera and microphone'}),(0,r.jsx)("li",{children:"Refresh the page and test again"})]})]})]})]})}),(0,r.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,r.jsx)("button",{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors",children:"testing"===g.camera||"testing"===g.microphone?"Testing...":"Test Media Access"}),"granted"===g.camera&&"granted"===g.microphone&&(0,r.jsx)("button",{onClick:()=>e.push("/verbfy-talk"),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors",children:"Ready to Join Rooms"})]}),(0,r.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"Browser Requirements"}),(0,r.jsx)("p",{className:"text-blue-700 text-sm",children:"VerbfyTalk works best with modern browsers like Chrome, Firefox, Safari, or Edge. Make sure your browser is up to date for the best experience."})]})]})})}}},function(e){e.O(0,[5522,2138,9226,9496,8484,437,1883,7,747,3365,8638,9806,7093,8510,8424,8639,7855,7446,2169,8308,1408,6259,4657,8212,1088,1493,2888,5514,179],function(){return e(e.s=22282)}),_N_E=e.O()}]);