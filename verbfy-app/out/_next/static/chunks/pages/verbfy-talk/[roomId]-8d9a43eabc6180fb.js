(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8939],{4333:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verbfy-talk/[roomId]",function(){return s(74501)}])},74501:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=s(85893),o=s(67294),r=s(11163),i=s(11088),a=s(54310),l=s(32798),c=s(64964),d=s(32201),u=s(68606),m=s(96019),g=s(35892),h=s(71263),p=s(24585),x=s(61937),b=s(22877);function y(){var e,t;let s=(0,r.useRouter)(),{roomId:y}=s.query,{t:v}=(0,a.Q)(),[f,w]=(0,o.useState)(null),[j,D]=(0,o.useState)(!0),[N,k]=(0,o.useState)(!1),[S,C]=(0,o.useState)(!1),[A,M]=(0,o.useState)(""),[E,P]=(0,o.useState)(!1),[T,R]=(0,o.useState)(!1),[F,U]=(0,o.useState)(!1),[W,Z]=(0,o.useState)(0),[_,I]=(0,o.useState)([]),[q,L]=(0,o.useState)(null),[O,B]=(0,o.useState)([]),[G,J]=(0,o.useState)(""),[H,z]=(0,o.useState)(!1),[V,K]=(0,o.useState)(100),[X,Q]=(0,o.useState)(!1),Y=(0,o.useRef)(null),$=(0,o.useRef)(new Map),ee=(0,o.useRef)(null),et=(0,o.useRef)(null);(0,o.useEffect)(()=>{y&&(async()=>{try{var e,t;let s=await l.bl.getRoomDetails(y);if(w(s.data||s),(null===(e=s.data)||void 0===e?void 0:e.participants)||(null==s?void 0:s.participants)){let e=((null===(t=s.data)||void 0===t?void 0:t.participants)||(null==s?void 0:s.participants)).some(e=>e.isActive);C(e)}}finally{D(!1)}})()},[y]),(0,o.useEffect)(()=>{let e=e=>{"granted"===e.target.state&&(console.log("\uD83C\uDFA4 Permission granted via change event"),L(null),es())};navigator.permissions&&navigator.permissions.query({name:"microphone"}).then(t=>{t.addEventListener("change",e),"granted"===t.state&&(console.log("\uD83C\uDFA4 Permission already granted, initializing audio..."),es())}).catch(e=>{console.log("⚠️ Could not query microphone permission:",e)});let t=setTimeout(()=>{if("WebSocket"in window){console.log("\uD83D\uDD0C WebSocket support detected");try{let e=new WebSocket("wss://api.verbfy.com/socket.io/");e.onopen=()=>{console.log("✅ WebSocket connection test successful"),e.close()},e.onerror=e=>{console.warn("⚠️ WebSocket connection test failed:",e),console.log("\uD83D\uDD04 Falling back to polling transport")},setTimeout(()=>{e.readyState===WebSocket.OPEN&&e.close()},5e3)}catch(e){console.warn("⚠️ WebSocket test failed:",e)}}else console.warn("⚠️ WebSocket not supported, using polling fallback")},2e3),s=(()=>{console.log("\uD83D\uDD0C Attempting to establish WebSocket connection...");let e=0,t=()=>{if(e>=3)return console.log("\uD83D\uDED1 Maximum WebSocket retry attempts reached, using polling fallback"),()=>{};try{let s=new WebSocket("wss://api.verbfy.com/socket.io/");s.onopen=()=>{console.log("✅ WebSocket connection established successfully"),e=0,s.send(JSON.stringify({type:"test",data:"connection_test"}))},s.onmessage=e=>{console.log("\uD83D\uDCE8 WebSocket message received:",e.data)},s.onerror=t=>{console.warn("⚠️ WebSocket connection error:",t),e++,console.log("\uD83D\uDD04 WebSocket retry attempt ".concat(e,"/").concat(3)),e>=3?console.log("\uD83D\uDED1 WebSocket failed after maximum retries, using polling fallback"):console.log("\uD83D\uDD04 Falling back to polling transport")},s.onclose=s=>{console.log("\uD83D\uDD0C WebSocket connection closed:",s.code,s.reason),1e3!==s.code&&(++e<3?(console.log("\uD83D\uDD04 Attempting to reconnect... (".concat(e,"/").concat(3,")")),setTimeout(t,3e3)):console.log("\uD83D\uDED1 Maximum reconnection attempts reached, using polling fallback"))};let n={current:s};return()=>{n.current&&n.current.readyState===WebSocket.OPEN&&n.current.close()}}catch(s){return console.warn("⚠️ WebSocket connection failed:",s),++e<3?(console.log("\uD83D\uDD04 Retrying WebSocket connection... (".concat(e,"/").concat(3,")")),setTimeout(t,3e3)):console.log("\uD83D\uDED1 WebSocket failed after maximum retries, using polling fallback"),()=>{}}};return t()})();return()=>{navigator.permissions&&navigator.permissions.query({name:"microphone"}).then(t=>{t.removeEventListener("change",e)}).catch(()=>{}),clearTimeout(t),s()}},[]);let es=async()=>{try{let e;if(console.log("\uD83C\uDFA4 Requesting microphone permission..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw Error("Microphone access not supported in this browser");if(!window.isSecureContext)throw Error("Microphone access requires a secure context (HTTPS or localhost)");try{let e=await navigator.permissions.query({name:"microphone"});if(e.state,console.log("\uD83D\uDD0D Microphone permission status:",e.state),"denied"===e.state)throw Error("Microphone permission permanently denied. Please enable it in browser settings.")}catch(e){console.log("⚠️ Could not check permission status, proceeding with getUserMedia")}try{e=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(t){console.log("⚠️ Basic audio failed, trying with specific constraints..."),e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:44100,channelCount:1}})}console.log("✅ Microphone permission granted"),Y.current=e,ee.current=new AudioContext;let t=ee.current.createMediaStreamSource(e);et.current=ee.current.createAnalyser(),t.connect(et.current);let s=new Uint8Array(et.current.frequencyBinCount),n=()=>{if(et.current){et.current.getByteFrequencyData(s);let e=s.reduce((e,t)=>e+t)/s.length;Z(e),U(e>30)}requestAnimationFrame(n)};n(),L(null),console.log("\uD83C\uDFA4 Audio initialized successfully")}catch(s){console.error("❌ Failed to initialize audio:",s);let e="Failed to access microphone",t=!0;throw"NotAllowedError"===s.name?e="Microphone permission denied. Please allow microphone access and try again.":"NotFoundError"===s.name?e="No microphone found. Please connect a microphone and try again.":"NotSupportedError"===s.name?(e="Microphone access not supported in this browser.",t=!1):"NotReadableError"===s.name?e="Microphone is already in use by another application.":s.message.includes("secure context")?(e="Microphone access requires HTTPS. Please use https://verbfy.com instead of http.",t=!1):s.message.includes("permanently denied")&&(e="Microphone access permanently blocked. Please enable it in browser settings: Chrome Settings > Privacy > Site Settings > Microphone > Allow.",t=!1),L({message:e,showRetry:t}),s}},en=async()=>{try{console.log("\uD83D\uDE80 Attempting to bypass permissions policy...");let e=document.createElement("audio");e.style.display="none",document.body.appendChild(e);try{await e.play(),console.log("✅ User interaction triggered via audio play")}catch(e){console.log("⚠️ Audio play failed, trying alternative method")}document.body.removeChild(e);let t=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});Y.current=t,L(null),ee.current=new AudioContext;let s=ee.current.createMediaStreamSource(t);et.current=ee.current.createAnalyser(),s.connect(et.current),console.log("✅ Microphone access granted via policy bypass!")}catch(s){console.error("❌ Policy bypass failed:",s),console.log("\uD83D\uDD04 Trying alternative bypass methods...");try{var e;let t=document.createElement("iframe");t.style.display="none",t.src="about:blank",document.body.appendChild(t),(t.contentDocument||(null===(e=t.contentWindow)||void 0===e?void 0:e.document))&&console.log("\uD83D\uDD27 Attempting microphone access from iframe context..."),document.body.removeChild(t)}catch(e){console.log("⚠️ Iframe method failed:",e)}let t=null;for(let e of[{audio:!0},{audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}},{audio:{sampleRate:8e3,channelCount:1}},{audio:{sampleRate:16e3,channelCount:1}}])try{console.log("\uD83C\uDFA4 Trying audio constraints:",e),t=await navigator.mediaDevices.getUserMedia(e),console.log("✅ Microphone access granted with constraints:",e);break}catch(e){console.log("⚠️ Constraints failed:",e);continue}if(t){Y.current=t,L(null),ee.current=new AudioContext;let e=ee.current.createMediaStreamSource(t);et.current=ee.current.createAnalyser(),e.connect(et.current),console.log("✅ Microphone access granted via alternative constraints!");return}L({message:"All policy bypass methods failed. Please try browser settings or contact support.",showRetry:!0})}},eo=()=>{var e,t,s,n,o,r;if(!G.trim()||!S)return;let i={id:Date.now(),text:G.trim(),sender:{id:(null==f?void 0:null===(s=f.participants)||void 0===s?void 0:null===(t=s.find(e=>e.isActive))||void 0===t?void 0:null===(e=t.userId)||void 0===e?void 0:e._id)||"unknown",name:(null==f?void 0:null===(r=f.participants)||void 0===r?void 0:null===(o=r.find(e=>e.isActive))||void 0===o?void 0:null===(n=o.userId)||void 0===n?void 0:n.name)||"Unknown"},timestamp:new Date().toISOString()};B(e=>[...e,i]),J("")},er=()=>{if(Y.current&&!T){Q(!0);let e=Y.current.getAudioTracks()[0];e&&(e.enabled=!0)}},ei=()=>{if(Y.current&&H){Q(!1);let e=Y.current.getAudioTracks()[0];e&&(e.enabled=!1)}},ea=e=>{if(K(e),Y.current&&Y.current.getAudioTracks()[0]){var t;let s=null===(t=ee.current)||void 0===t?void 0:t.createGain();s&&(s.gain.value=e/100)}},el=async()=>{if(y){if((null==f?void 0:f.isPrivate)&&!A){P(!0);return}try{if(k(!0),(await l.bl.joinRoom(y,{password:A})).success){C(!0),M(""),P(!1),await es();let e=await l.bl.getRoomDetails(y);w(e.data||e)}}catch(s){var e,t;console.error("Failed to join room:",s),alert((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to join room")}finally{k(!1)}}},ec=async()=>{if(y)try{Y.current&&Y.current.getTracks().forEach(e=>e.stop()),$.current.forEach(e=>e.close()),$.current.clear(),await l.bl.leaveRoom(y),C(!1),s.push("/verbfy-talk")}catch(e){console.error("Failed to leave room:",e)}},ed=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return j?(0,n.jsx)(i.Z,{title:"Loading Room...",children:(0,n.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading room details..."})}):f?(0,n.jsx)(i.Z,{title:f.name||"VerbfyTalk Room",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,n.jsx)(d.Z,{className:"w-8 h-8 text-blue-600"}),f.name]}),(0,n.jsx)("p",{className:"text-gray-600 mt-2",children:f.description}),(0,n.jsxs)("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[f.isPrivate?(0,n.jsx)(u.Z,{className:"w-4 h-4"}):(0,n.jsx)(m.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:f.isPrivate?"Private":"Public"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"Beginner":return(0,n.jsx)(c.Z,{className:"w-4 h-4 text-green-500"});case"Intermediate":return(0,n.jsx)(c.Z,{className:"w-4 h-4 text-yellow-500"});case"Advanced":return(0,n.jsx)(c.Z,{className:"w-4 h-4 text-red-500"});default:return(0,n.jsx)(c.Z,{className:"w-4 h-4 text-blue-500"})}})(f.level),(0,n.jsx)("span",{children:f.level})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(g.Z,{className:"w-4 h-4"}),(0,n.jsxs)("span",{children:[(null===(e=f.participants)||void 0===e?void 0:e.filter(e=>e.isActive).length)||0,"/",f.maxParticipants]})]}),f.startedAt&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.Z,{className:"w-4 h-4"}),(0,n.jsxs)("span",{children:["Started ",ed(f.startedAt)]})]})]})]}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:S?(0,n.jsx)("button",{onClick:ec,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Leave Room"}):(0,n.jsx)("button",{onClick:el,disabled:N,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50",children:N?"Joining...":"Join Room"})})]}),f.topic&&(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Discussion Topic"}),(0,n.jsx)("p",{className:"text-blue-800",children:f.topic})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(g.Z,{className:"w-5 h-5"}),"Participants (",(null===(t=f.participants)||void 0===t?void 0:t.filter(e=>e.isActive).length)||0,")"]}),S&&(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,n.jsxs)("h3",{className:"font-medium text-blue-900 mb-3 flex items-center gap-2",children:[(0,n.jsx)(p.Z,{className:"w-5 h-5"}),"Voice Chat Controls"]}),Y.current?(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("button",{onClick:()=>{if(Y.current){let e=Y.current.getAudioTracks()[0];e&&(e.enabled=!e.enabled,R(!e.enabled))}},className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat(T?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,n.jsx)(x.Z,{className:"w-5 h-5 ".concat(T?"text-red-600":"text-green-600")}),T?"Unmute":"Mute"]}),(0,n.jsxs)("button",{onClick:()=>z(!H),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat(H?"bg-purple-100 text-purple-700 hover:bg-purple-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,n.jsx)(b.Z,{className:"w-5 h-5"}),H?"Push-to-Talk ON":"Push-to-Talk OFF"]})]}),H&&(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("button",{onMouseDown:er,onMouseUp:ei,onTouchStart:er,onTouchEnd:ei,className:"flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-all ".concat(X?"bg-red-500 text-white scale-105":"bg-blue-500 text-white hover:bg-blue-600"),children:[(0,n.jsx)(x.Z,{className:"w-5 h-5"}),X?"Recording...":"Hold to Talk"]}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"Hold the button while speaking"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-sm text-gray-700 min-w-[80px]",children:"Volume:"}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",value:V,onChange:e=>ea(Number(e.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,n.jsxs)("span",{className:"text-sm text-gray-600 min-w-[40px]",children:[V,"%"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-sm text-gray-700 min-w-[80px]",children:"Audio Level:"}),(0,n.jsx)("div",{className:"flex-1 w-full h-3 bg-gray-200 rounded-lg overflow-hidden",children:(0,n.jsx)("div",{className:"h-full transition-all duration-100 ".concat(F?"bg-green-500":"bg-blue-500"),style:{width:"".concat(Math.min(2*W,100),"%")}})}),(0,n.jsx)("span",{className:"text-sm text-gray-600 min-w-[60px]",children:F?"Speaking":"Silent"})]})]}):(0,n.jsxs)("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,n.jsx)("p",{className:"text-yellow-800 text-sm mb-2",children:"\uD83D\uDD12 Microphone access required for voice chat"}),q&&(0,n.jsxs)("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,n.jsxs)("p",{className:"text-red-800 text-sm mb-2",children:["❌ ",q.message]}),q.showRetry&&(0,n.jsx)("button",{onClick:()=>{L(null),es()},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs font-medium transition-colors",children:"\uD83D\uDD04 Try Again"})]}),(0,n.jsx)("button",{onClick:()=>{L(null),es()},className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"\uD83C\uDFA4 Enable Microphone"}),(0,n.jsx)("button",{onClick:async()=>{try{if(navigator.permissions){let e=await navigator.permissions.query({name:"microphone"});"prompt"===e.state&&await navigator.mediaDevices.getUserMedia({audio:!0})}}catch(e){console.log("Manual permission request failed:",e)}},className:"ml-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-xs font-medium transition-colors",children:"\uD83D\uDD27 Force Permission"}),(0,n.jsx)("button",{onClick:async()=>{try{console.log("\uD83C\uDFAF User interaction detected, attempting microphone access...");let e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});Y.current=e,L(null),ee.current=new AudioContext;let t=ee.current.createMediaStreamSource(e);et.current=ee.current.createAnalyser(),t.connect(et.current),console.log("✅ Microphone access granted via user interaction!")}catch(e){console.error("❌ User interaction method failed:",e),L({message:"User interaction method failed. Please try the main Enable Microphone button.",showRetry:!0})}},className:"ml-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"\uD83C\uDFAF User Interaction"}),(0,n.jsx)("button",{onClick:en,className:"ml-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"\uD83D\uDE80 Policy Bypass"}),(0,n.jsxs)("div",{className:"mt-2 text-xs text-yellow-700",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"\uD83D\uDCA1 Troubleshooting:"})}),(0,n.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,n.jsx)("li",{children:"Make sure you're using HTTPS (https://verbfy.com)"}),(0,n.jsx)("li",{children:"Check browser microphone permissions in settings"}),(0,n.jsx)("li",{children:"Ensure no other apps are using the microphone"}),(0,n.jsx)("li",{children:"Try refreshing the page if permission was denied"}),(0,n.jsx)("li",{children:(0,n.jsx)("strong",{children:'If "Permissions policy violation" error:'})}),(0,n.jsx)("li",{children:'• Click "User Interaction" button first'}),(0,n.jsx)("li",{children:'• Try "Policy Bypass" button'}),(0,n.jsx)("li",{children:'• Use "Force Permission" button'}),(0,n.jsx)("li",{children:"• Check browser security settings"}),(0,n.jsx)("li",{children:"• Disable any browser extensions blocking permissions"}),(0,n.jsx)("li",{children:"• Try incognito/private browsing mode"})]})]})]}),(0,n.jsxs)("div",{className:"mt-3 text-xs text-blue-700",children:[(0,n.jsxs)("p",{children:["\uD83D\uDCA1 ",(0,n.jsx)("strong",{children:"Voice Chat Tips:"})]}),(0,n.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,n.jsx)("li",{children:'Click "Enable Microphone" to start voice chat'}),(0,n.jsx)("li",{children:"Use Mute/Unmute to control your audio"}),(0,n.jsx)("li",{children:"Enable Push-to-Talk for hands-free operation"}),(0,n.jsx)("li",{children:"Adjust volume slider to control microphone sensitivity"}),(0,n.jsx)("li",{children:"Green indicator shows when you're speaking"})]})]})]}),f.participants&&f.participants.length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.participants.filter(e=>e.isActive).filter((e,t,s)=>s.findIndex(t=>t.userId._id===e.userId._id)===t).map((e,t)=>{var s,o,r;return(0,n.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium",children:(null===(o=e.userId)||void 0===o?void 0:null===(s=o.name)||void 0===s?void 0:s.charAt(0))||"U"}),e.isSpeaking&&(0,n.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white animate-pulse"})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("p",{className:"font-medium text-gray-900",children:(null===(r=e.userId)||void 0===r?void 0:r.name)||"Unknown User"}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Joined ",ed(e.joinedAt)]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,n.jsx)(x.Z,{className:"w-4 h-4 ".concat(e.isMuted?"text-red-500":"text-green-500")}),(0,n.jsx)("span",{className:"text-xs text-gray-500",children:e.isMuted?"Muted":"Active"})]})]})]},"".concat(e.userId._id,"-").concat(t))})}):(0,n.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No participants yet"})]}),S&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,n.jsx)(d.Z,{className:"w-5 h-5"}),"Room Chat"]}),(0,n.jsx)("div",{className:"h-64 overflow-y-auto border border-gray-200 rounded-lg p-3 mb-3 bg-gray-50",children:0===O.length?(0,n.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No messages yet. Start the conversation!"}):(0,n.jsx)("div",{className:"space-y-2",children:O.map(e=>(0,n.jsxs)("div",{className:"flex items-start gap-2",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-medium",children:e.sender.name.charAt(0)}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"font-medium text-gray-900",children:e.sender.name}),(0,n.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,n.jsx)("p",{className:"text-gray-700",children:e.text})]})]},e.id))})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{type:"text",value:G,onChange:e=>J(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eo())},placeholder:"Type your message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!S}),(0,n.jsx)("button",{onClick:eo,disabled:!G.trim()||!S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Send"})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:"\uD83D\uDCA1 Press Enter to send, Shift+Enter for new line"})]}),E&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enter Room Password"}),(0,n.jsx)("input",{type:"password",value:A,onChange:e=>M(e.target.value),placeholder:"Enter password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4"}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{onClick:()=>{P(!1),M("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,n.jsx)("button",{onClick:el,disabled:N,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:N?"Joining...":"Join"})]})]})})]})}):(0,n.jsx)(i.Z,{title:"Room Not Found",children:(0,n.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Room not found"})})}}},function(e){e.O(0,[1216,1088,2888,179],function(){return e(e.s=4333)}),_N_E=e.O()}]);
//# sourceMappingURL=[roomId]-8d9a43eabc6180fb.js.map