(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9635],{7061:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return a(78723)}])},78723:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(85893),n=a(67294),d=a(11088),i=a(32798),l=a(54310);function r(){let{t:e}=(0,l.Q)(),[t,a]=(0,n.useState)([]),[r,c]=(0,n.useState)(!0),[m,o]=(0,n.useState)([]),[x,h]=(0,n.useState)(""),[p,u]=(0,n.useState)("all"),[j,g]=(0,n.useState)({}),y=async()=>{c(!0);try{var e,t,s,n;let d=await i.ZP.get("/api/admin/teachers/pending");a(d.data.data||[]);let l=await i.Sb.getUsers({search:x,role:"all"===p?void 0:p,limit:50});o(null!==(n=null!==(s=null!==(t=null===(e=l.data)||void 0===e?void 0:e.users)&&void 0!==t?t:l.data)&&void 0!==s?s:l.users)&&void 0!==n?n:[])}finally{c(!1)}};(0,n.useEffect)(()=>{y()},[]);let v=async e=>{await i.ZP.patch("/api/admin/teachers/".concat(e,"/approve")),await y()},N=async e=>{await i.ZP.patch("/api/admin/teachers/".concat(e,"/reject"),{reason:"Not meeting requirements"}),await y()},f=async(e,t)=>{try{await i.Sb.updateUserRole(e,t),await y()}catch(e){}},b=async(e,t)=>{try{await i.Sb.updateUserStatus(e,t),await y()}catch(e){}};return(0,s.jsx)(d.Z,{allowedRoles:["admin"],title:e("admin.users.title","User Management"),children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:e("admin.users.pending","Pending Teacher Applications")}),r?(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:e("common.loading","Loading...")}):0===t.length?(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:e("admin.users.noPending","No pending applications")}):(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2",children:(0,s.jsx)("input",{type:"checkbox","aria-label":"Select all",checked:t.length>0&&t.every(e=>j[e._id]),onChange:e=>{let a=e.target.checked,s={};t.forEach(e=>s[e._id]=a),g(e=>({...e,...s}))}})}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.name","Name")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.email","Email")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.actions","Actions")})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-100",children:t.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("input",{type:"checkbox",checked:!!j[t._id],onChange:e=>g(a=>({...a,[t._id]:e.target.checked}))})}),(0,s.jsx)("td",{className:"px-4 py-2",children:t.name}),(0,s.jsx)("td",{className:"px-4 py-2",children:t.email}),(0,s.jsxs)("td",{className:"px-4 py-2 space-x-2",children:[(0,s.jsx)("button",{onClick:()=>v(t._id),className:"px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700",children:e("admin.approve","Approve")}),(0,s.jsx)("button",{onClick:()=>N(t._id),className:"px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700",children:e("admin.reject","Reject")})]})]},t._id))})]}),(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:async()=>{for(let e of Object.keys(j).filter(e=>j[e]))await v(e)},className:"px-3 py-2 rounded-md bg-green-600 text-white hover:bg-green-700",children:[e("admin.approve","Approve")," (",Object.values(j).filter(Boolean).length,")"]}),(0,s.jsxs)("button",{onClick:async()=>{for(let e of Object.keys(j).filter(e=>j[e]))await N(e)},className:"px-3 py-2 rounded-md bg-red-600 text-white hover:bg-red-700",children:[e("admin.reject","Reject")," (",Object.values(j).filter(Boolean).length,")"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:e("admin.users.all","All Users")}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{value:x,onChange:e=>h(e.target.value),placeholder:e("admin.search","Search..."),className:"border rounded-md px-3 py-2"}),(0,s.jsxs)("select",{value:p,onChange:e=>u(e.target.value),className:"border rounded-md px-3 py-2",children:[(0,s.jsx)("option",{value:"all",children:e("admin.all","All")}),(0,s.jsx)("option",{value:"student",children:e("admin.student","Student")}),(0,s.jsx)("option",{value:"teacher",children:e("admin.teacher","Teacher")}),(0,s.jsx)("option",{value:"admin",children:e("admin.admin","Admin")})]}),(0,s.jsx)("button",{onClick:y,className:"px-3 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700",children:e("admin.refresh","Refresh")})]})]}),r?(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:e("common.loading","Loading...")}):0===m.length?(0,s.jsx)("div",{className:"py-8 text-center text-gray-500",children:e("admin.users.empty","No users found")}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.name","Name")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.email","Email")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.role","Role")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.status","Status")}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:e("admin.actions","Actions")})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-100",children:m.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:t.name}),(0,s.jsx)("td",{className:"px-4 py-2",children:t.email}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsxs)("select",{value:t.role,onChange:e=>f(t._id,e.target.value),className:"border rounded-md px-2 py-1 text-sm",children:[(0,s.jsx)("option",{value:"student",children:e("admin.student","Student")}),(0,s.jsx)("option",{value:"teacher",children:e("admin.teacher","Teacher")}),(0,s.jsx)("option",{value:"admin",children:e("admin.admin","Admin")})]})}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsxs)("select",{value:t.approvalStatus||"approved",onChange:e=>b(t._id,e.target.value),className:"border rounded-md px-2 py-1 text-sm",children:[(0,s.jsx)("option",{value:"approved",children:e("admin.approved","Approved")}),(0,s.jsx)("option",{value:"pending",children:e("admin.pending","Pending")}),(0,s.jsx)("option",{value:"rejected",children:e("admin.rejected","Rejected")})]})}),(0,s.jsxs)("td",{className:"px-4 py-2",children:[(0,s.jsx)("button",{onClick:()=>b(t._id,"approved"),className:"px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700 mr-2",children:e("admin.approve","Approve")}),(0,s.jsx)("button",{onClick:()=>b(t._id,"rejected"),className:"px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700",children:e("admin.reject","Reject")})]})]},t._id))})]})})]})]})})}}},function(e){e.O(0,[1216,1088,2888,179],function(){return e(e.s=7061)}),_N_E=e.O()}]);