(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5888],{80502:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/materials/[id]",function(){return t(51167)}])},51167:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var i=t(85893),s=t(67294),l=t(11163),n=t(72509),d=t(32798),o=t(7878),r=t(36197),c=t(10571);function u(){let e=(0,l.useRouter)(),{id:a}=e.query,{user:t}=(0,r.aC)(),[u,m]=(0,s.useState)(null),[p,x]=(0,s.useState)(!0),[g,h]=(0,s.useState)(null),[v,f]=(0,s.useState)(!1),b=(null==t?void 0:t.role)==="teacher"||(null==t?void 0:t.role)==="admin",y=(null==u?void 0:u.uploaderId._id)===(null==t?void 0:t._id),w=b&&(y||(null==t?void 0:t.role)==="admin"),j=async()=>{if(a)try{x(!0),h(null);let e=await d.ZP.get("/api/materials/".concat(a));e.data.success&&m(e.data.data)}catch(i){var e,t;let a=(null===(t=i.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load material";h(a),n.Am.error(a)}finally{x(!1)}};(0,s.useEffect)(()=>{a&&j()},[a]);let D=async()=>{if(u){f(!0);try{let e=await d.ZP.get("/api/materials/".concat(u._id,"/download"),{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download",u.originalName),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(a),n.Am.success("Download started")}catch(i){var e,a;let t=(null===(a=i.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Failed to download material";n.Am.error(t)}finally{f(!1)}}},N=async()=>{if(u&&w&&confirm("Are you sure you want to delete this material? This action cannot be undone."))try{(await d.ZP.delete("/api/materials/".concat(u._id))).data.success&&(n.Am.success("Material deleted successfully"),e.push("/materials"))}catch(i){var a,t;let e=(null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to delete material";n.Am.error(e)}};return p?(0,i.jsx)(c.Z,{children:(0,i.jsx)("div",{className:"p-6",children:(0,i.jsxs)("div",{className:"animate-pulse",children:[(0,i.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),(0,i.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})})}):g||!u?(0,i.jsx)(c.Z,{children:(0,i.jsx)("div",{className:"p-6",children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"❌"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Material Not Found"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:g||"The requested material could not be found."}),(0,i.jsx)("button",{onClick:()=>e.push("/materials"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Back to Materials"})]})})}):(0,i.jsx)(c.Z,{children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:u.originalName}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,i.jsxs)("span",{className:"flex items-center",children:[(0,o.cF)(u.type),(0,i.jsx)("span",{className:"ml-1",children:(0,o.Av)(u.type)})]}),(0,i.jsx)("span",{children:(0,o.sS)(u.fileSize)}),(0,i.jsxs)("span",{children:["Uploaded ",(0,o.p6)(u.createdAt)]})]})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{onClick:D,disabled:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:v?"Downloading...":"Download"}),w&&(0,i.jsx)("button",{onClick:N,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Delete"})]})]}),u.tags&&u.tags.length>0&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Tags:"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:u.tags.map((e,a)=>(0,i.jsx)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-sm",children:e},a))})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Preview"}),(()=>{if(!u)return null;let e=u.type,a="/api/materials/".concat(u._id,"/preview");switch(e){case"image":return(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("img",{src:a,alt:u.originalName,className:"max-w-full h-auto rounded-lg shadow-lg"})});case"video":return(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsxs)("video",{controls:!0,className:"max-w-full h-auto rounded-lg shadow-lg",children:[(0,i.jsx)("source",{src:a,type:u.mimeType}),"Your browser does not support the video tag."]})});case"pdf":return(0,i.jsx)("div",{className:"w-full h-96",children:(0,i.jsx)("iframe",{src:a,className:"w-full h-full border rounded-lg",title:u.originalName})});default:return(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:(0,o.cF)(u.type)}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:u.originalName}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"This file type cannot be previewed directly."}),(0,i.jsx)("button",{onClick:D,disabled:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:v?"Downloading...":"Download File"})]})}})()]})]})})}},7878:function(e,a,t){"use strict";t.d(a,{Av:function(){return n},Tb:function(){return s},cF:function(){return l},p6:function(){return o},sS:function(){return d},vH:function(){return i}});let i={pdf:{label:"PDF Document",icon:"\uD83D\uDCC4",extensions:[".pdf"],mimeTypes:["application/pdf"]},image:{label:"Image",icon:"\uD83D\uDDBC️",extensions:[".jpg",".jpeg",".png",".gif",".webp"],mimeTypes:["image/jpeg","image/jpg","image/png","image/gif","image/webp"]},video:{label:"Video",icon:"\uD83C\uDFA5",extensions:[".mp4",".webm",".ogg",".avi"],mimeTypes:["video/mp4","video/webm","video/ogg","video/avi"]},document:{label:"Document",icon:"\uD83D\uDCDD",extensions:[".doc",".docx",".txt"],mimeTypes:["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"]},audio:{label:"Audio",icon:"\uD83C\uDFB5",extensions:[".mp3",".wav",".ogg"],mimeTypes:["audio/mpeg","audio/wav","audio/ogg","audio/mp3"]}},s=52428800,l=e=>{var a;return e.includes("/")?e.startsWith("image/")?"\uD83D\uDDBC️":e.startsWith("video/")?"\uD83C\uDFA5":e.startsWith("audio/")?"\uD83C\uDFB5":"application/pdf"===e?"\uD83D\uDCC4":"\uD83D\uDCDD":(null===(a=i[e])||void 0===a?void 0:a.icon)||"\uD83D\uDCC4"},n=e=>{var a;return e.includes("/")?e.startsWith("image/")?"Image":e.startsWith("video/")?"Video":e.startsWith("audio/")?"Audio":"application/pdf"===e?"PDF Document":"Document":(null===(a=i[e])||void 0===a?void 0:a.label)||"File"},d=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}},function(e){e.O(0,[2138,9226,9496,8484,437,5823,2244,6235,5323,747,3365,8638,9806,7093,8510,8424,8639,7855,7446,2169,8308,1408,6259,4657,8212,571,1493,2888,5514,179],function(){return e(e.s=80502)}),_N_E=e.O()}]);