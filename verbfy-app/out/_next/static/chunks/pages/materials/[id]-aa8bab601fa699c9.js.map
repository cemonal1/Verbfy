{"version":3,"file":"static/chunks/pages/materials/[id]-aa8bab601fa699c9.js","mappings":"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","sources":["webpack://_N_E/?96e0","webpack://_N_E/./pages/materials/[id].tsx","webpack://_N_E/./src/types/materials.ts"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/materials/[id]\",\n      function () {\n        return require(\"private-next-pages/materials/[id].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/materials/[id]\"])\n      });\n    }\n  ","import React, { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport { toast } from 'react-hot-toast';\r\nimport api from '@/lib/api';\r\nimport { Material, getFileTypeIcon, getFileTypeLabel, formatFileSize, formatDate } from '@/types/materials';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport DashboardLayout from '@/components/layout/DashboardLayout';\r\n\r\nexport default function MaterialPreviewPage() {\r\n  const router = useRouter();\r\n  const { id } = router.query;\r\n  const { user } = useAuth();\r\n  \r\n  const [material, setMaterial] = useState<Material | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isDownloading, setIsDownloading] = useState(false);\r\n\r\n  // Check permissions\r\n  const canDelete = user?.role === 'teacher' || user?.role === 'admin';\r\n  const isOwner = material?.uploaderId._id === user?._id;\r\n  const canManage = canDelete && (isOwner || user?.role === 'admin');\r\n\r\n  // Fetch material details\r\n  const fetchMaterial = async () => {\r\n    if (!id) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const response = await api.get(`/api/materials/${id}`);\r\n      \r\n      if (response.data.success) {\r\n        setMaterial(response.data.data);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error fetching material:', error);\r\n      const errorMessage = error.response?.data?.message || 'Failed to load material';\r\n      setError(errorMessage);\r\n      toast.error(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      fetchMaterial();\r\n    }\r\n  }, [id]);\r\n\r\n  // Handle download\r\n  const handleDownload = async () => {\r\n    if (!material) return;\r\n\r\n    setIsDownloading(true);\r\n    try {\r\n      const response = await api.get(`/api/materials/${material._id}/download`, {\r\n        responseType: 'blob'\r\n      });\r\n\r\n      // Create download link\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.setAttribute('download', material.originalName);\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success('Download started');\r\n    } catch (error: any) {\r\n      console.error('Download error:', error);\r\n      const errorMessage = error.response?.data?.message || 'Failed to download material';\r\n      toast.error(errorMessage);\r\n    } finally {\r\n      setIsDownloading(false);\r\n    }\r\n  };\r\n\r\n  // Handle delete\r\n  const handleDelete = async () => {\r\n    if (!material || !canManage) return;\r\n\r\n    if (!confirm('Are you sure you want to delete this material? This action cannot be undone.')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await api.delete(`/api/materials/${material._id}`);\r\n      \r\n      if (response.data.success) {\r\n        toast.success('Material deleted successfully');\r\n        router.push('/materials');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Delete error:', error);\r\n      const errorMessage = error.response?.data?.message || 'Failed to delete material';\r\n      toast.error(errorMessage);\r\n    }\r\n  };\r\n\r\n  // Get preview component based on file type\r\n  const getPreviewComponent = () => {\r\n    if (!material) return null;\r\n\r\n    const fileType = material.type;\r\n    const previewUrl = `/api/materials/${material._id}/preview`;\r\n\r\n    switch (fileType) {\r\n      case 'image':\r\n        return (\r\n          <div className=\"flex justify-center\">\r\n            <img \r\n              src={previewUrl} \r\n              alt={material.originalName}\r\n              className=\"max-w-full h-auto rounded-lg shadow-lg\"\r\n            />\r\n          </div>\r\n        );\r\n      \r\n      case 'video':\r\n        return (\r\n          <div className=\"flex justify-center\">\r\n            <video \r\n              controls \r\n              className=\"max-w-full h-auto rounded-lg shadow-lg\"\r\n            >\r\n              <source src={previewUrl} type={material.mimeType} />\r\n              Your browser does not support the video tag.\r\n            </video>\r\n          </div>\r\n        );\r\n      \r\n      case 'pdf':\r\n        return (\r\n          <div className=\"w-full h-96\">\r\n            <iframe\r\n              src={previewUrl}\r\n              className=\"w-full h-full border rounded-lg\"\r\n              title={material.originalName}\r\n            />\r\n          </div>\r\n        );\r\n      \r\n      default:\r\n        return (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-gray-400 text-6xl mb-4\">\r\n              {getFileTypeIcon(material.type)}\r\n            </div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n              {material.originalName}\r\n            </h3>\r\n            <p className=\"text-gray-600 mb-4\">\r\n              This file type cannot be previewed directly.\r\n            </p>\r\n            <button\r\n              onClick={handleDownload}\r\n              disabled={isDownloading}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50\"\r\n            >\r\n              {isDownloading ? 'Downloading...' : 'Download File'}\r\n            </button>\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return (\r\n      <DashboardLayout>\r\n        <div className=\"p-6\">\r\n          <div className=\"animate-pulse\">\r\n            <div className=\"h-8 bg-gray-200 rounded w-1/3 mb-6\"></div>\r\n            <div className=\"h-64 bg-gray-200 rounded\"></div>\r\n          </div>\r\n        </div>\r\n      </DashboardLayout>\r\n    );\r\n  }\r\n\r\n  // Error state\r\n  if (error || !material) {\r\n    return (\r\n      <DashboardLayout>\r\n        <div className=\"p-6\">\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-gray-400 text-6xl mb-4\">❌</div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n              Material Not Found\r\n            </h3>\r\n            <p className=\"text-gray-600 mb-4\">\r\n              {error || 'The requested material could not be found.'}\r\n            </p>\r\n            <button\r\n              onClick={() => router.push('/materials')}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n            >\r\n              Back to Materials\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DashboardLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <DashboardLayout>\r\n      <div className=\"p-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-start mb-6\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n              {material.originalName}\r\n            </h1>\r\n            <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\r\n              <span className=\"flex items-center\">\r\n                {getFileTypeIcon(material.type)}\r\n                <span className=\"ml-1\">{getFileTypeLabel(material.type)}</span>\r\n              </span>\r\n              <span>{formatFileSize(material.fileSize)}</span>\r\n              <span>Uploaded {formatDate(material.createdAt)}</span>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex space-x-2\">\r\n            <button\r\n              onClick={handleDownload}\r\n              disabled={isDownloading}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50\"\r\n            >\r\n              {isDownloading ? 'Downloading...' : 'Download'}\r\n            </button>\r\n            \r\n            {canManage && (\r\n              <button\r\n                onClick={handleDelete}\r\n                className=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\"\r\n              >\r\n                Delete\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tags */}\r\n        {material.tags && material.tags.length > 0 && (\r\n          <div className=\"mb-6\">\r\n            <h3 className=\"text-sm font-medium text-gray-700 mb-2\">Tags:</h3>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {material.tags.map((tag, index) => (\r\n                <span\r\n                  key={index}\r\n                  className=\"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-sm\"\r\n                >\r\n                  {tag}\r\n                </span>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Preview */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Preview</h3>\r\n          {getPreviewComponent()}\r\n        </div>\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n} ","export interface Material {\r\n  _id: string;\r\n  uploaderId: {\r\n    _id: string;\r\n    name: string;\r\n    email: string;\r\n    role: 'student' | 'teacher' | 'admin';\r\n  };\r\n  originalName: string;\r\n  savedName: string;\r\n  type: 'pdf' | 'image' | 'video' | 'document' | 'audio';\r\n  mimeType: string;\r\n  fileSize: number;\r\n  tags: string[];\r\n  role: 'teacher' | 'student' | 'admin';\r\n  description?: string;\r\n  isPublic: boolean;\r\n  downloadCount: number;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  previewURL?: string;\r\n}\r\n\r\nexport interface MaterialFilters {\r\n  type: string;\r\n  tags: string;\r\n  search: string;\r\n  isPublic: string;\r\n  uploaderId?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\nexport interface MaterialUploadData {\r\n  file: File;\r\n  tags?: string;\r\n  description?: string;\r\n  isPublic?: boolean;\r\n}\r\n\r\nexport interface MaterialUpdateData {\r\n  tags?: string;\r\n  description?: string;\r\n  isPublic?: boolean;\r\n}\r\n\r\nexport interface MaterialsResponse {\r\n  success: boolean;\r\n  data: {\r\n    materials: Material[];\r\n    pagination: {\r\n      page: number;\r\n      limit: number;\r\n      total: number;\r\n      pages: number;\r\n    };\r\n  };\r\n  message: string;\r\n}\r\n\r\nexport interface MaterialResponse {\r\n  success: boolean;\r\n  data: Material;\r\n  message: string;\r\n}\r\n\r\nexport interface UploadResponse {\r\n  success: boolean;\r\n  data: Material;\r\n  message: string;\r\n}\r\n\r\n// File type configurations\r\nexport const FILE_TYPES = {\r\n  pdf: {\r\n    label: 'PDF Document',\r\n    icon: '📄',\r\n    extensions: ['.pdf'],\r\n    mimeTypes: ['application/pdf']\r\n  },\r\n  image: {\r\n    label: 'Image',\r\n    icon: '🖼️',\r\n    extensions: ['.jpg', '.jpeg', '.png', '.gif', '.webp'],\r\n    mimeTypes: ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp']\r\n  },\r\n  video: {\r\n    label: 'Video',\r\n    icon: '🎥',\r\n    extensions: ['.mp4', '.webm', '.ogg', '.avi'],\r\n    mimeTypes: ['video/mp4', 'video/webm', 'video/ogg', 'video/avi']\r\n  },\r\n  document: {\r\n    label: 'Document',\r\n    icon: '📝',\r\n    extensions: ['.doc', '.docx', '.txt'],\r\n    mimeTypes: [\r\n      'application/msword',\r\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n      'text/plain'\r\n    ]\r\n  },\r\n  audio: {\r\n    label: 'Audio',\r\n    icon: '🎵',\r\n    extensions: ['.mp3', '.wav', '.ogg'],\r\n    mimeTypes: ['audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/mp3']\r\n  }\r\n} as const;\r\n\r\nexport const MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB\r\n\r\nexport const getFileTypeIcon = (typeOrMimeType: Material['type'] | string): string => {\r\n  // If it's a MIME type, determine the type from it\r\n  if (typeOrMimeType.includes('/')) {\r\n    if (typeOrMimeType.startsWith('image/')) return '🖼️';\r\n    if (typeOrMimeType.startsWith('video/')) return '🎥';\r\n    if (typeOrMimeType.startsWith('audio/')) return '🎵';\r\n    if (typeOrMimeType === 'application/pdf') return '📄';\r\n    return '📝';\r\n  }\r\n  \r\n  // If it's a type string, use the existing logic\r\n  return FILE_TYPES[typeOrMimeType as Material['type']]?.icon || '📄';\r\n};\r\n\r\nexport const getFileTypeLabel = (typeOrMimeType: Material['type'] | string): string => {\r\n  // If it's a MIME type, determine the type from it\r\n  if (typeOrMimeType.includes('/')) {\r\n    if (typeOrMimeType.startsWith('image/')) return 'Image';\r\n    if (typeOrMimeType.startsWith('video/')) return 'Video';\r\n    if (typeOrMimeType.startsWith('audio/')) return 'Audio';\r\n    if (typeOrMimeType === 'application/pdf') return 'PDF Document';\r\n    return 'Document';\r\n  }\r\n  \r\n  // If it's a type string, use the existing logic\r\n  return FILE_TYPES[typeOrMimeType as Material['type']]?.label || 'File';\r\n};\r\n\r\nexport const formatFileSize = (bytes: number): string => {\r\n  if (bytes === 0) return '0 Bytes';\r\n  \r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  \r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n};\r\n\r\nexport const formatDate = (dateString: string): string => {\r\n  const date = new Date(dateString);\r\n  return date.toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  });\r\n}; "],"names":["window","__NEXT_P","push","__webpack_require__","MaterialPreviewPage","router","useRouter","id","query","user","useAuth","material","setMaterial","useState","loading","setLoading","error","setError","isDownloading","setIsDownloading","canDelete","role","isOwner","uploaderId","_id","canManage","fetchMaterial","response","api","get","concat","data","success","console","errorMessage","message","toast","useEffect","handleDownload","responseType","url","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","originalName","body","appendChild","click","remove","revokeObjectURL","handleDelete","confirm","delete","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","DashboardLayout","div","className","jsxs","h3","p","button","onClick","h1","span","getFileTypeIcon","type","getFileTypeLabel","formatFileSize","fileSize","formatDate","createdAt","disabled","tags","length","map","tag","index","getPreviewComponent","fileType","previewUrl","img","src","alt","video","controls","source","mimeType","iframe","title","FILE_TYPES","pdf","label","icon","extensions","mimeTypes","image","audio","MAX_FILE_SIZE","includes","startsWith","typeOrMimeType","bytes","i","Math","floor","log","parseFloat","pow","toFixed","sizes","date","Date","dateString","toLocaleDateString","year","month","day","hour","minute"],"sourceRoot":""}