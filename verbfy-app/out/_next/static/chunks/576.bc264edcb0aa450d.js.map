{"version":3,"file":"static/chunks/576.bc264edcb0aa450d.js","mappings":"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","sources":["webpack://_N_E/./src/components/livekit/LiveKitRoom.tsx","webpack://_N_E/./src/context/LiveKitContext.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport {\r\n  VideoConference,\r\n  GridLayout,\r\n  ParticipantTile,\r\n  ControlBar,\r\n  useTracks,\r\n  RoomAudioRenderer\r\n} from '@livekit/components-react';\r\nimport { Track } from 'livekit-client';\r\nimport { useLiveKit } from '../../context/LiveKitContext';\r\nimport '@livekit/components-styles';\r\n\r\ninterface LiveKitRoomProps {\r\n  roomName: string;\r\n  onError?: (error: Error) => void;\r\n  onConnected?: () => void;\r\n  onDisconnected?: () => void;\r\n}\r\n\r\nexport const LiveKitRoom: React.FC<LiveKitRoomProps> = ({\r\n  roomName,\r\n  onError,\r\n  onConnected,\r\n  onDisconnected\r\n}) => {\r\n  const { room, isConnecting, error, connect, disconnect } = useLiveKit();\r\n\r\n  useEffect(() => {\r\n    if (roomName) {\r\n      connect(roomName)\r\n        .then(() => {\r\n          console.log('✅ Connected to LiveKit room:', roomName);\r\n          onConnected?.();\r\n        })\r\n        .catch((err) => {\r\n          console.error('❌ Failed to connect to LiveKit room:', err);\r\n          onError?.(err);\r\n        });\r\n    }\r\n\r\n    return () => {\r\n      disconnect();\r\n      onDisconnected?.();\r\n    };\r\n  }, [roomName, connect, disconnect, onConnected, onDisconnected, onError]);\r\n\r\n  if (isConnecting) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\r\n          <p className=\"mt-4\">Connecting to room...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full\">\r\n        <div className=\"text-center text-red-500\">\r\n          <p>Failed to connect: {error.message}</p>\r\n          <button\r\n            onClick={() => connect(roomName)}\r\n            className=\"mt-4 px-4 py-2 bg-primary text-white rounded hover:bg-primary-dark\"\r\n          >\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!room) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-full\">\r\n        <p>Room not connected</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"h-full\">\r\n      <VideoConference>\r\n        <GridLayout tracks={useTracks()}>\r\n          <ParticipantTile />\r\n        </GridLayout>\r\n        <RoomAudioRenderer />\r\n        <ControlBar />\r\n      </VideoConference>\r\n    </div>\r\n  );\r\n}; ","import React, { createContext, useContext, useState, useCallback } from 'react';\r\nimport { Room, RoomOptions } from 'livekit-client';\r\nimport api from '../lib/api';\r\n\r\ninterface LiveKitContextType {\r\n  room: Room | null;\r\n  isConnecting: boolean;\r\n  error: Error | null;\r\n  connect: (roomName: string) => Promise<void>;\r\n  disconnect: () => void;\r\n}\r\n\r\nconst LiveKitContext = createContext<LiveKitContextType | undefined>(undefined);\r\n\r\nexport const useLiveKit = () => {\r\n  const context = useContext(LiveKitContext);\r\n  if (!context) {\r\n    throw new Error('useLiveKit must be used within a LiveKitProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\ninterface LiveKitProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const LiveKitProvider: React.FC<LiveKitProviderProps> = ({ children }) => {\r\n  const [room, setRoom] = useState<Room | null>(null);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  const connect = useCallback(async (roomName: string) => {\r\n    try {\r\n      setIsConnecting(true);\r\n      setError(null);\r\n\r\n      // Get token from backend\r\n      const response = await api.post(`/api/livekit/token/${roomName}`);\r\n      const { token, url } = response.data;\r\n\r\n      // Initialize room options\r\n      const roomOptions: RoomOptions = {\r\n        adaptiveStream: true,\r\n        dynacast: true,\r\n        stopLocalTrackOnUnpublish: true\r\n      };\r\n\r\n      // Create and connect room\r\n      const newRoom = new Room(roomOptions);\r\n      await newRoom.connect(url, token);\r\n\r\n      setRoom(newRoom);\r\n    } catch (err) {\r\n      console.error('Failed to connect to LiveKit room:', err);\r\n      setError(err as Error);\r\n      throw err;\r\n    } finally {\r\n      setIsConnecting(false);\r\n    }\r\n  }, []);\r\n\r\n  const disconnect = useCallback(() => {\r\n    if (room) {\r\n      room.disconnect();\r\n      setRoom(null);\r\n    }\r\n  }, [room]);\r\n\r\n  return (\r\n    <LiveKitContext.Provider\r\n      value={{\r\n        room,\r\n        isConnecting,\r\n        error,\r\n        connect,\r\n        disconnect\r\n      }}\r\n    >\r\n      {children}\r\n    </LiveKitContext.Provider>\r\n  );\r\n}; "],"names":["LiveKitRoom","roomName","onError","onConnected","onDisconnected","param","room","isConnecting","error","connect","disconnect","useLiveKit","useEffect","then","console","log","catch","err","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","div","className","jsxs","p","message","button","onClick","VideoConference","GridLayout","tracks","useTracks","ParticipantTile","RoomAudioRenderer","ControlBar","LiveKitContext","createContext","undefined","context","useContext","LiveKitProvider","children","setRoom","useState","setIsConnecting","setError","useCallback","token","url","response","api","post","concat","data","newRoom","Room","adaptiveStream","dynacast","stopLocalTrackOnUnpublish","Provider","value"],"sourceRoot":""}